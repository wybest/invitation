<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0071) -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=8">

<title>{新郎}与{新娘}婚宴邀约</title>
<meta name="description" content="{宴客日期}">

	<link href="./example_files/styles.css" type="text/css" rel="stylesheet">
	<link href="./example_files/photoswipe.css" type="text/css" rel="stylesheet">
	<script type="text/javascript" charset="utf-8" async="" src="./example_files/b.js"></script><script type="text/javascript" async="" src="./example_files/dc.js"></script><script src="./example_files/hm.js"></script><script type="text/javascript" src="./example_files/klass.min.js"></script>



<link href="./example_files/movcard.css.asp" rel="stylesheet" type="text/css">

<link rel="stylesheet" href="./example_files/jquery-ui-1.8.18.custom.full_leo.css" type="text/css" media="screen" charset="utf-8">

<script type="text/javascript" src="./example_files/firefox_xml_maxthon.js"></script>
<script type="text/javascript" src="./example_files/jquery-latest.js"></script>
<script type="text/javascript" src="./example_files/jquery-ui-1.8.18.full.min.js"></script>

	<script src="./example_files/api" type="text/javascript"></script><script type="text/javascript" src="./example_files/getscript"></script><link rel="stylesheet" type="text/css" href="./example_files/bmap.css">

<script type="text/javascript" src="./example_files/ckeditor.js"></script>
<script type="text/javascript" src="./example_files/date.format.js"></script>
<script type="text/javascript">



function MM_goToURL() { //v3.0
  var i, args=MM_goToURL.arguments; document.MM_returnValue = false;
  for (i=0; i<(args.length-1); i+=2) eval(args[i]+".location='"+args[i+1]+"'");
}
function MM_preloadImages() { //v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}

function MM_swapImgRestore() { //v3.0
  var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++) x.src=x.oSrc;
}

function MM_findObj(n, d) { //v4.01
  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x && d.getElementById) x=d.getElementById(n); return x;
}

function MM_swapImage() { //v3.0
  var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array; for(i=0;i<(a.length-2);i+=3)
   if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc) x.oSrc=x.src; x.src=a[i+2];}
}


		
  		var bshow7042 = 1;
		
  		var bshow7041 = 1;
		
  		var bshow7043 = 1;
		
  		var bshow7044 = 1;

			
				  var geocoder7044;
				  
				  function codeAddress7044(address) {
					//var address = document.getElementById("address7044").value;
				 
			//alert(address);	 
					// Baidu map ?建地址解析器?例
					geocoder7044 = new BMap.Geocoder();
					// ?地址解析?果?示在地?上,并?整地??野
					geocoder7044.getPoint(address, function(point){
					  if (point) {
						map7044.setCenter(point);
						marker7044.setPosition(point);
						$('#invite_detail_latcenter7044').val(point.lat);  
						$('#invite_detail_lngcenter7044').val(point.lng);  
						$('#invite_detail_latmarker7044').val(point.lat);  
						$('#invite_detail_lngmarker7044').val(point.lng);  
				
						$('#iframepage').get(0).contentWindow.setMapCenter7044(point.lng,point.lat);	
						$('#iframepage').get(0).contentWindow.setMarkerPos7044(point.lng,point.lat);	  
				
				
					  } else {
						alert("定位失败, 请修改地址後再试一次，失败原因： " + status);
					  }
					}, "");
				
				  }
				  
				//baidu map
				  var map7044 = null;
				  var marker7044;
				  var map7044_latcenter = 31.240629;
				  var map7044_lngcenter = 121.512625;
				  var map7044_latmarker = 31.241401;
				  var map7044_lngmarker = 121.512876;
				  
				  
				  
				  function initialize7044() {
				
				//Baidu MAP Control
					map7044 = new BMap.Map("map_canvas7044");
				//alert (map7044_latcenter + "," + map7044_lngcenter);
				
					//var point = new BMap.Point(116.404, 39.915);  // ?建?坐?
					//var point = new BMap.Point(map7044_lngcenter, map7044_latcenter );  // ?建?坐?
					map7044.centerAndZoom(new BMap.Point(map7044_lngcenter, map7044_latcenter ),  16);                 // 初始化地?，?置中心?坐?和地???
				
					var opts = {type: BMAP_NAVIGATION_CONTROL_ZOOM}  
					map7044.addControl(new BMap.NavigationControl(opts));  
					//map7044.addControl(new BMap.ScaleControl());  
					//map7044.addControl(new BMap.OverviewMapControl());  
					//map7044.addControl(new BMap.MapTypeControl());
					//var opts = {anchor: BMAP_ANCHOR_BOTTOM_RIGHT }  
					//map7044.addControl(new CopyrightControl(opts));
				
				
					map7044.addEventListener("click", function(e){
						//alert("你??了地?");
						$('#invite_detail_latmarker7044').val(e.point.lat);  
						$('#invite_detail_lngmarker7044').val(e.point.lng);  
						marker7044.setPosition(e.point);
						$('#iframepage').get(0).contentWindow.setMarkerPos7044(e.point.lng,e.point.lat);	  
					});
				
					map7044.addEventListener("moving", function(){  
					 var center = map7044.getCenter();  
					 //alert("地?中心??更?：" + center.lng + ", " + center.lat);  
					 $('#invite_detail_latcenter7044').val(center.lat);  
					 $('#invite_detail_lngcenter7044').val(center.lng);  
					 $('#iframepage').get(0).contentWindow.setMapCenter7044(center.lng,center.lat);	
					});  
				
					map7044.addEventListener("zoomend", function(){  
					 $('#invite_detail_zoom7044').val(map7044.getZoom());  
					 $('#iframepage').get(0).contentWindow.setMapZoom7044(map7044.getZoom());	  
					});
				
					// ?建???象  
					var myIcon = new BMap.Icon("images/mobile_invite/map_marker.png", new BMap.Size(34, 34), {  
					// 指定定位位置。  
					// ??注?示在地?上?，其所指向的地理位置距离??左上  
					   // 角各偏移10像素和25像素。您可以看到在本例中?位置即是  
					   // ??中央下端的尖角位置。  
					   offset: new BMap.Size(17, 34),  
					   // ?置?片偏移。  
					   // ?您需要?一幅?大的?片中截取某部分作??注???，您  
					   // 需要指定大?的偏移位置，此做法与css sprites技??似。  
					   imageOffset: new BMap.Size(0,0)   // ?置?片偏移  
					 });    
					 // ?建?注?象并添加到地?  
				
					marker7044 = new BMap.Marker(
						new BMap.Point(map7044_lngmarker, map7044_latmarker), 
						{	
							icon: myIcon, 
							enableDragging: true,
							raiseOnDrag: true,
							title: "拖拽以標注地點" 
						}
					); // ?建?注  
					
					marker7044.addEventListener("dragging", function(e){
					
					 $('#invite_detail_latmarker7044').val(e.point.lat);  
					 $('#invite_detail_lngmarker7044').val(e.point.lng);  
					 $('#iframepage').get(0).contentWindow.setMarkerPos7044(e.point.lng,e.point.lat);	  
					
					
					});
					map7044.addOverlay(marker7044);                     
				  }
				  
			
			
					
  		var bshow7046 = 1;
		
  		var bshow7045 = 1;
  
  


$(function() {

	$( "#accordion_header" ).accordion({
		autoHeight: false, 
		collapsible: true
	});
	
	$("#accordion_header").bind('accordionchange', function(event, ui) {
	 // ui.newHeader // jQuery object, activated header
	 // ui.oldHeader // jQuery object, previous header
	 // ui.newContent // jQuery object, activated content
	 // ui.oldContent // jQuery object, previous content
	 //  alert($(ui.newHeader).attr("id") + " was opened, " + $(ui.oldHeader).attr("id") + " was closed");
	 //   console.log(ui.newHeader.attr('id'));
		if (ui.newHeader.attr('id') == 'header')
		{
			 $('#iframepage').contents().find('html, body').animate({scrollTop: 0});
		}
		
		
	});
		
	
	$( "#accordion_detail" ).accordion({
		autoHeight: false, 
		collapsible: false
	});


});



$(document).ready(function(){
  $('input[type=text][title],input[type=password][title],textarea[title]').each(function(i){
    $(this).addClass('input-prompt-' + i);
    var promptSpan = $('<span class="input-prompt"/>');
    $(promptSpan).attr('id', 'input-prompt-' + i);
    $(promptSpan).append($(this).attr('title'));
    $(promptSpan).click(function(){
      $(this).hide();
      $('.' + $(this).attr('id')).focus();
    });
    if($(this).val() != ''){
      $(promptSpan).hide();
    }
    $(this).before(promptSpan);
    $(this).focus(function(){
      $('#input-prompt-' + i).hide();
    });

    $(this).change(function(){
      if($(this).val() != ''){
        $('#input-prompt-' + i).hide();
      }
    });
    $(this).blur(function(){
      if($(this).val() == ''){
        $('#input-prompt-' + i).show();
      }
    });
  });
});


function indexOfStr(strArray, searchString) {
	var found = -1;
	
	for (var i = 0; i < strArray.length; i++) {
	  if (strArray[i] == searchString) {
		found = i;
		break;
	  }
	}
	return found;
}

function getMinTextInOrder(txt){
	var txt_array_inorder = txt.split('').sort();
	
	if (txt_array_inorder.length > 0) {
		txt_min = txt_array_inorder[0]; 
		prechr = txt_array_inorder[0];
		for (i=1; i<txt_array_inorder.length; i++){
			if (txt_array_inorder[i] != prechr){
				prechr = txt_array_inorder[i];
				txt_min = txt_min + txt_array_inorder[i];
			}
		}
	} else {
		txt_min = "";
	}

	return txt_min;	
}



function getMainPanelText(){

	var panel_text = '本服务由YouVivid.com提供' + $('#invite_maintitle').val() + $('#invite_subtitle').val();
	$('.tab_name').each( function () {
		panel_text = panel_text + $(this).val();
	});
	return encodeURIComponent(getMinTextInOrder(panel_text));
}

var delay = (function(){
  var timer = 0;
  return function(callback, ms){
	clearTimeout (timer);
	timer = setTimeout(callback, ms);
  };
})();


var webfont_index = 1;

function reloadMainPanelFont(){

	var fontData = $("#invite_fontface option:selected").val();
	//alert(fontData);
	var fontfamily = fontData.split('|')[0];
	var fontface = fontData.split('|')[1];
	var bwebfont = fontData.split('|')[2];
	var webfonttype = fontData.split('|')[3];
	
	if (bwebfont == 1) {
		if (webfonttype==3){
			$('#iframepage').contents().find(".fontcss").attr("href",fontface); 
		} else {
			fontfamily = fontfamily.split(',')[0] + webfont_index;
			fontface = fontface.split('&font=')[0] + webfont_index + '&font=' + fontface.split('&font=')[1];
		//alert(fontfamily );
		//alert(fontface );
			fontface=fontface + "&text=" + getMainPanelText();
		//	alert( 'fontfamily=' + fontfamily + ', fontface=' + fontface);
			//alert(fontface);
			//$('#iframepage').contents().find(".fontcss").remove();
			//$('#iframepage').contents().find('head').append('<link class="fontcss"  rel="stylesheet" type="text/css" href="'+ fontface +'">');
			
			$('#iframepage').contents().find(".fontcss").attr("href",fontface); 
			webfont_index = webfont_index + 1;
		}
		
	}
	$('#iframepage').contents().find("body").css("font-family",fontfamily); 
	$('#iframepage').contents().find(".ui-widget").css("font-family",fontfamily); 

}




$(document).ready(function() { 



//alert(getMainPanelText());
	$("#invite_style").change(function() {
		$('#invite_stylename').val($("#invite_style option:selected").text());  

		var stylecssurl = $(this).val().split('|')[0];
		var styleimagefolder = $(this).val().split('|')[1];
		var customstylecssurl = $(this).val().split('|')[2];
		var styletype = $(this).val().split('|')[3];
		$('#invite_styleid').val($(this).val().split('|')[4]);  

		$('#iframepage').contents().find(".themecss").attr("href",stylecssurl); 
		$('#iframepage').contents().find(".customcss").attr("href",customstylecssurl); 
//alert($('#iframepage').contents().find('#iconimage').attr('alt'));
		$('#iframepage').contents().find('.iconimage').each(function () {
			//alert($(this).attr('alt'));
			imageName = $(this).attr('alt');
			$(this).attr('src', styleimagefolder + imageName);
			//alert($(this).attr('src'));
		});
		$('#iframepage').get(0).contentWindow.invite_styletype = styletype;
		
		$('#iframepage').get(0).contentWindow.initProcessButtonBackground();	//call iframe function to reset id	 

		
	});



	$("#invite_fontface").change(function() {
		$('#invite_fontname').val($("#invite_fontface option:selected").text());  
		reloadMainPanelFont();
	});







	$("#invite_maintitle,#invite_subtitle,.tab_name").keyup(function() {


		delay(function(){

			reloadMainPanelFont();

		}, 1000 );

	});




	$(".tab_name").addClass("tab_name_idle");
/*
	$(".tab_name").focus(function() {
		$(this).removeClass("tab_name_idle").addClass("tab_name_focus");
	});
	$(".tab_name").blur(function() {
		$(this).removeClass("tab_name_focus").addClass("tab_name_idle");
	});
	
	$(".tab_name").hover(function() {
		  $(this).removeClass('tab_name_idle'); 
		  $(this).addClass('tab_name_hover');
	   }, 
	   function() {
		  $(this).removeClass('tab_name_hover'); 
		  $(this).addClass('tab_name_idle');
	   }
	);
*/

	//$( "#tabs" ).tabs({selected: 3});
	$( "#tabs" ).tabs({selected: -1});
	//$( "#tabs" ).tabs({ disabled: [2, 3] });

	$( "#tabs" ).tabs().find( ".ui-tabs-nav" ).sortable({ axis: "x",
		//start: function(event, ui) { alert("start sort") },
		items: 'li',
		update: function(event, ui) {
			var id_selected = ui.item.attr("id");
			var id_array = $(this).sortable('toArray');
			 //console.log( id_selected );
			 //console.log( id_array );
	
			 
			 //index_selected = id_array.indexOf(id_selected);
			 index_selected = indexOfStr(id_array,id_selected);
			 
			 
//			 console.log( index_selected );
			 if (index_selected != 0) {
				var id_moveto = id_array[index_selected-1];
				$('#iframepage').contents().find('#invite_detail_title' + id_selected ).insertAfter($('#iframepage').contents().find('#invite_detail_content' + id_moveto));	 
				 
			 } else {
				var id_moveto =  id_array[1];
				$('#iframepage').contents().find('#invite_detail_title' + id_selected ).insertBefore($('#iframepage').contents().find('#invite_detail_title' + id_moveto));	 
			 }
			$('#iframepage').contents().find('#invite_detail_content' + id_selected ).insertAfter($('#iframepage').contents().find('#invite_detail_title' + id_selected));
			 
			 
			 
			$('#iframepage').get(0).contentWindow.processButtonBackground();	//call iframe function	 
			 
			 
			 //
			 
			//var invite_detail_id = ui.tab.id.substr(19, ui.tab.id.length - 19 );
			//alert(invite_detail_id);
			//$("#div2").insertAfter("#div3");
		//$('#iframepage').contents().find('#invite_detail_title660').insertAfter($('#iframepage').contents().find('#invite_detail_content657'));
			//$('#iframepage').contents().find('#invite_detail_content660').insertAfter($('#iframepage').contents().find('#invite_detail_title660'));

			//$('#iframepage').contents().find('div[name="button1"]').attr('id','button400'); 
			//var id_buf = $('#iframepage').contents().find('div[name="button1"]').attr('id'); 
			//alert(id_buf);
			
		}
		//change: function(event, ui) { alert("change sort")}

	});



	$('#tabs').bind('tabsselect', function(event, ui) {
		//ui.tab     // anchor element of the selected (clicked) tab
		//ui.panel   // element, that contains the selected/clicked tab contents
		//ui.index   // zero-based index of the selected (clicked) tab
		//alert($("#accordion_header").accordion("activate"));
		$("#accordion_header").accordion("activate", false );
		
		
		//"invite_detail_title" length = 19
		var invite_detail_id = ui.tab.id.substr(19, ui.tab.id.length - 19 );
		
		//alert(invite_detail_id);
		$(".tab_name").removeClass("tab_name_idle");
		//$(".tab_name").removeClass("tab_name_focus");
		$(".tab_name").addClass("tab_name_idle");
		$("#invite_detail_name" + invite_detail_id ).removeClass("tab_name_idle");

		var tabSelected = ui.index;
		//alert($('#tabs').tabs( "option", "selected" ))
		var accordionActive = $('#iframepage').get(0).contentWindow.$("#accordion").accordion( "option", "active" );
	    //console.log("tabSelected=" + tabSelected + ", " + "accordionActive=" + accordionActive );		
		
		if (accordionActive===false){
			accordionActive = -1;
		}
//	    console.log("tabSelected=" + tabSelected + ", " + "accordionActive=" + accordionActive );		
//	    console.log(accordionActive);		
//		console.log($('#iframepage').contents().find('h3>a[id^="invite_detail_title"]')[accordionActive].id);
		//console.log($("input[id='invite_detail_id']")[0]);
		
		//var bshow = eval("bshow" + $("input[id='invite_detail_id']")[ui.index].value);
		var bshow = eval("bshow" + invite_detail_id);
		//console.log("bshow" + $("input[id='invite_detail_id']")[ui.index].value + "=" + bshow );
		//console.log($("input[id='invite_detail_id']")[0]);
		if (tabSelected != accordionActive && bshow == 1) {
			//alert("open accordion:" + tabSelected);
		//if (tabSelected != accordionActive ) {
			
			if($.browser.msie && parseInt($.browser.version, 10) <= 7) {
				// delay for open accordion because ie7 ie8 will hang
				setTimeout(function() {$('#iframepage').get(0).contentWindow.$("#accordion").accordion("activate",tabSelected);},1250);
			} else {
				$('#iframepage').get(0).contentWindow.$("#accordion").accordion("activate",tabSelected);
			}
			
			// '#accordion > div:has(#item117) > h3'
			//$('#iframepage').get(0).contentWindow.$("#accordion").accordion("activate","h3:has(#" + ui.tab.id +")" );
		}
	});


	 // initial when tab open 
                  
	var bReloadWebFontOnce = 1;

			// reload web font when new created invite replace text from dialog 
	
			$('#tabs').bind('tabsshow', function(event, ui) {
				if (ui.panel.id == 'invite_detail_content7042' )
				{
					if (bReloadWebFontOnce == 1) {
						ck_editor.execCommand( 'reloadWebFont');
						bReloadWebFontOnce = 0;
					}
					
				}
			});
	

	
			$('#tabs').bind('tabsshow', function(event, ui) {
				if (ui.panel.id == 'invite_detail_content7044' && !map7044 && $("#invite_detail_mapimgurl7044").val() == '')
				{
					//alert("initialize7044");
					initialize7044();
					//resizeMap();
					
				}
			});






});

/*
$('#iframepage').ready(function() { 

	$("#load_title").click(function() {
		alert("load_title");
		//$('#title_editor').elrte('val', $('#iframepage').contents().find("#title").html() );
		//$('#title_editor').elrte('updateSource');
	});

	$("#save_title").click(function() {
		alert("save_title");
		//$('#iframepage').contents().find("#title").html($('#title_editor').elrte('val')) ;
	});


	alert("iframepage ready: " + $('#iframepage').contents().find("#title").html() );
	//$('#title_editor').elrte('val',$('#iframepage').contents().find("#title").html() );
	return false;

});
*/




</script>




<title>無標題文件</title>
<style type="text/css">



.tab_name_idle {
    border: 1px solid transparent;
	background-color:transparent;
}
.tab_name_hide { color:#AAA;
}

.global_setting {
	margin:3px 3px 3px 3px;
}
/*

.section-header {
	margin:4px 0px 4px 0px;
	padding:0px 0px 0px 0px;
	height:22px;
	background-color:#AAA;
	color:#FFF;
	font-size:16px;
	border-style:none;
	
}
*/

.section-content {
	padding:0px;
	margin: 0px;
}

.input-prompt {
  position: absolute;
  font-style: italic;
  color: #ddd;
  margin: 0.2em 0 0 0.5em;
}

</style>




<style type="text/css">
<!--  
  .showText{
    
    font-size:9pt; 
    border:0px solid #333;
  }

  .showInput{
    
    font-size:9pt; 
    border:1px solid #333;
    background:#FFFFEB;
	
  }
  
  
 .editable {
	border:0px solid;
  }
 .editable:hover {
	border:2px dotted;
  }

//-->
</style>
  

<script language="javascript">
<!--

$(document).ready(function() { 

   //$(this).scrollTop(0);
});


<!-- fix jquery dialog bug of modal:true scrollbar  -->
(function( $, undefined ) {
  if ($.ui && $.ui.dialog) {
    $.ui.dialog.overlay.events = $.map('focus,keydown,keypress'.split(','), function(event) { return event + '.dialog-overlay'; }).join(' ');
  }
}(jQuery));


  String.prototype.trim = function() { return this.replace(/^\s\s*/, '').replace(/\s\s*$/, '');};
  
  String.prototype.ReplaceAll = function (AFindText,ARepText){
  
    raRegExp = new RegExp(AFindText,"g");
    return this.replace(raRegExp,ARepText)
  } 

  function countWords(){
    
    var limitcount, keycount;
        
    if (engstr( document.form_invite.remindmsg.value)){
        limitcount = 140;  
    }else{
        limitcount = 70;
    }    
    
    //keycount = document.form_invite.remindmsg.value.trim().ReplaceAll(' ', '').replace(/\r\n/g,'').length;
    
    keycount = document.form_invite.remindmsg.value.length;
        
    document.getElementById('limitcount').innerHTML = limitcount;
    
    
    
    if (keycount > limitcount){
        
        //alert('您輸入的簡訊內容超過字數了');  
        document.form_invite.remindmsg.value = document.form_invite.remindmsg.value.substring(0,limitcount);
        
        keycount = document.form_invite.remindmsg.value.length;
    }
    
    
    document.getElementById('keycount').innerHTML = keycount;
        
  }


function engstr(str){
   var subStr = "";
   for (i=0,n=str.length;i<n;i++){
      subStr = str.charCodeAt(i);
      if ((subStr > 256)){
         return false;
      }
   }
   return true;
}

  function isIns(){
    
    
    
  }


  var maxid = 89993;

  function addRow(parent_node){
  
   
    maxid++;
    
    //取得屬於要應用新增列的區塊
    var obj=document.getElementById( parent_node);
    //取得目前有多少欄位
    //var sIndex=obj.getElementsByTagName('div').length+1;
    var sIndex = maxid;
    
    //依照原表單格式,先建一個div
    var div=document.createElement('div');
    div.id = 's'+sIndex; 
	div.style="valign: middle;";

    
    //再建立文字欄位,並指定相關屬性
    var input=document.createElement('input');
    input.type='radio';
    input.name='q'+parent_node.replace('q', '');
    //input.id='t'+sIndex;
    //把文字欄位和按鈕加到div中

    var span=document.createElement('span');
    span.className='editable';



    var txt=document.createElement('input');
    txt.type='text';
    txt.name='o'+parent_node.replace('q', '');
    txt.value='新增选项';
    txt.className='showText';
    txt.onfocus = function(){this.className='showInput';};   
    txt.onblur = function(){this.className='showText';};   
    txt.onkeyup = function(){setOptionTitle( sIndex, this.value);};   
    

    var del=document.createElement('img');
    del.src='./image/del.png';
    del.onclick = function(){ delRow( parent_node , 's' + sIndex );};   
    del.style.cursor='pointer';
    del.vspace='5';
    del.hspace='5';
    del.align='absmiddle';
    
    span.appendChild(txt);

    div.appendChild(del);

    div.appendChild(span);
	
    // div.appendChild(input);
    
  
     
    //把div加到區塊中
    obj.appendChild(div);
    
    window.frames.iframepage.addRow(parent_node, maxid);
    
  }

  function delRow(q, t){

    d = document.getElementById(t);

    d.parentNode.removeChild(d);
    

    window.frames.iframepage.delRow(q, t);
    
  }

  function addOption(parent_node){
  
   
    maxid++;
    
    //取得屬於要應用新增列的區塊
    var obj=document.getElementById( parent_node);
    //取得目前有多少欄位
    //var sIndex=obj.getElementsByTagName('div').length+1;
    var sIndex = maxid;
    
    //依照原表單格式,先建一個div
    var div=document.createElement('div');
    div.id = 's'+sIndex; 
    
    var span=document.createElement('span');
    span.className='editable';

    //再建立文字欄位,並指定相關屬性
    var input=document.createElement('input');
    input.type='radio';
    input.name='q'+parent_node.replace('q', '');
    //input.id='t'+sIndex;
    //把文字欄位和按鈕加到div中

    var txt=document.createElement('input');
    txt.type='text';
    txt.name='o'+parent_node.replace('q', '');
    txt.value='新增选项';
    txt.className='showText';
    txt.onfocus = function(){this.className='showInput';this.size=20;};   
    txt.onblur = function(){this.className='showText';this.size=this.value.length*2;};   
    txt.onkeyup = function(){window.frames.iframepage.updateSelect(parent_node, this.value);};   
    txt.onclick = function(){window.frames.iframepage.updateSelect(parent_node, this.value);};   
    


    var del=document.createElement('img');
    del.src='./image/del.png';
    del.onclick = function(){ delOption( parent_node , 's' + sIndex );};   
    del.style.cursor='pointer';
    del.vspace='5';
    del.hspace='5';
    del.align='absmiddle';
    
	span.appendChild(txt);
    div.appendChild(del);
    // div.appendChild(input);
    div.appendChild(span);
    
  
     
    //把div加到區塊中
    obj.appendChild(div);
    
    //alert(document.getElementById(parent_node).innerHTML);
    
    window.frames.iframepage.updateSelect(parent_node, '新增选项');
    
  }

  function delOption(q, t){

    d = document.getElementById(t);

    d.parentNode.removeChild(d);
    

    window.frames.iframepage.updateSelect(q);
    
  }


  function updateOption(t){
    
    
   var s = document.getElementById(t);
   var a = document.getElementById(t.replace('t', 'n'));
    
    var arr = a.value.split('\n')
    
    s.options.length = 0;
    
    s.options[0] = new Option(  '請選擇', 0);
    for (var i=0; i<arr.length; i++){
      
        if (arr[i] != ''){
           s.options[i+1] = new Option( arr[i], arr[i]);
        }
    }
    
  }

  function updateSelect(t){
    
    
   var s = document.getElementById(t);
   var a = document.getElementById(t.replace('t', 'n'));
    
    var arr = a.value.split('\n')
    
    s.options.length = 0;
    
    s.options[0] = new Option('請選擇', 0);
    for (var i=0; i<arr.length; i++){
      
        if (arr[i].Trim().length != 0){
           s.options[i+1] = new Option( arr[i], arr[i]);
        }
    }
    
  }


  function setQuestionTitle(qq, txt){
    
    
    window.frames.iframepage.setQuestionTitle(qq, txt);          
    
  }

  function setOptionTitle(o, txt){
    
    //txt.replace(',', '，');
    window.frames.iframepage.setOptionTitle(o, txt);          
    
  }
  
  function showQuestion(parent_node, check, pos){
    
    window.frames.iframepage.showQuestion(parent_node, check);      
    
    if (check){
      document.form_invite.switch_status[pos].value = '1';
    }else{
      document.form_invite.switch_status[pos].value = '0';
    }    
    
  }


  function doBold(id){
    
    var txt;
    
    txt = window.frames.iframepage.document.getElementById(id).childNodes[0];
    
    if ( txt.style.fontWeight == 'bold'){
      
         txt.style.fontWeight = 'normal';
         selOff( document.getElementById(id+'bold'));
                  
    }else{

         txt.style.fontWeight = 'bold';
         selOn( document.getElementById(id+'bold'));
         
    }
    
    setHiddenHtml(id);
    
    //alert( window.frames.iframepage.document.getElementById(id).innerHTML);
    
  }

  function doItalic(id){
    
    var txt;
    
    txt = window.frames.iframepage.document.getElementById(id).childNodes[0];
    
    if ( txt.style.fontStyle == 'italic'){
      
         txt.style.fontStyle = 'normal';
         selOff( document.getElementById(id+'italic'));
                  
    }else{
         
         txt.style.fontStyle = 'italic';
         selOn( document.getElementById(id+'italic'));

              
    }
    
    setHiddenHtml(id);
    
    //alert( window.frames.iframepage.document.getElementById(id).innerHTML);
    
  }
    
  function doUnderline(id){
    
    var txt;
    
    txt = window.frames.iframepage.document.getElementById(id).childNodes[0];
    
    if ( txt.style.textDecoration == 'underline'){
      
         txt.style.textDecoration = 'none';
         selOff( document.getElementById(id+'underline'));

                  
    }else{
         
         txt.style.textDecoration = 'underline';
         selOn( document.getElementById(id+'underline'));
               
    }
    
    setHiddenHtml(id);
    
    //alert( window.frames.iframepage.document.getElementById(id).innerHTML);
    
  }
  
  function doFontSize( id, fontsize){
     
    var txt;
    
    txt = window.frames.iframepage.document.getElementById(id).childNodes[0];
    
    txt.style.fontSize = fontsize + 'px';
    
    setHiddenHtml(id);              
    
  }

  function selOn(ctrl)
  {
  	ctrl.style.borderColor = '#000000';
  	ctrl.style.backgroundColor = '#B5BED6';
  	
  }
  
  function selOff(ctrl)
  {
  	ctrl.style.borderColor = '#ffffff';  
  	ctrl.style.backgroundColor = '#ffffff';
  }


  function setHiddenHtml(id){
  
     document.getElementById(id).value = window.frames.iframepage.document.getElementById(id).innerHTML;  
     
     //alert(document.getElementById(id).value);
  }
  
  
  
String.prototype.Trim = function() 

{ 

  return this.replace(/(^\s*)|(\s*$)/g, ""); 

} 
  

            
-->
</script>


<script type="text/javascript">

  function saveNew( act ){

	 for ( instance in CKEDITOR.instances )
         CKEDITOR.instances[instance].updateElement();
   
    var detail_id_value = '';
	var detail_id_array = $( "#tabs" ).tabs().find( ".ui-tabs-nav" ).sortable('toArray');
  	for (i=0; i<detail_id_array.length; i++){
		detail_id_value = detail_id_value + detail_id_array[i] + '|';
	}
    $("#invite_detailidarray").val(detail_id_value.substring(0,detail_id_value.length-1));
   
    $("#invite_act").val(act);
    document.form_invite.submit();
 

  } 



  function updateOld(act){
//alert(act);

    var detail_id_value = '';
	var detail_id_array = $( "#tabs" ).tabs().find( ".ui-tabs-nav" ).sortable('toArray');
  	for (i=0; i<detail_id_array.length; i++){
		detail_id_value = detail_id_value + detail_id_array[i] + '|';
	}
    $("#invite_detailidarray").val(detail_id_value.substring(0,detail_id_value.length-1));



	 for ( instance in CKEDITOR.instances )
         CKEDITOR.instances[instance].updateElement();
		 
     dataString = $("#form_invite").serialize();
 //alert(dataString);
        $.ajax({
        type: "POST",
        url: "mobile_invite_quicksave_act.asp",
        data: dataString,
        dataType: "json",
        success: function(data) {
 
            if(data.result == "OK"){
				if (act=='nextstep'){
					location.replace('mobile_invite_save.asp?invite_id=1534');
				} else {
					alert("已保存成功,你可随时在网页右上角 [帐户后台] > [我的喜讯]中查看或修改本喜讯");
				}
            } else {
				alert("储存失败!");
            }
 
        },
        error: function(data) {
				alert("储存失败!");
        }
		
 
        });         
 

  } 


</script>




<script type="text/javascript" charset="UTF-8" src="./example_files/bw.js"></script><script type="text/javascript" src="./example_files/config.js"></script><script>(function listenerTest() {
    window.addEventListener("message", function (event) {
        if (event.source !=  window) return;

        if (event.data.type && (event.data.type == "GET_VAR")) {
            var var_name = event.data.name, name, val = null;
            for (var i = 0, l = var_name.length; i < l; i++) {
                if (window[var_name[i]] != null) {
                    val = window[var_name[i]];
                    name = var_name[i];
                    break;
                }
            }

            if (var_name[0] == "_SPM_a" || var_name[0] == "_SPM_b") {
                name = var_name[0];
            }
            //val = var_name ? window[var_name] : null;
            console.log(var_name, val);
            window.postMessage({
                type: "SEND_VAR",
                name: name,
                value: val
            }, "*");
        }
    });
})();</script><link rel="stylesheet" type="text/css" href="./example_files/editor.css"><script type="text/javascript" src="./example_files/zh-cn.js"></script><script type="text/javascript" src="./example_files/plugin.js"></script><script type="text/javascript" src="./example_files/plugin(1).js"></script><script type="text/javascript" src="./example_files/default.js"></script><link rel="stylesheet" type="text/css" href="./example_files/m-front-icon.css"><script type="text/javascript" language="javascript" id="BDBridgeSendData" src="./example_files/Enter.php" charset="UTF-8"></script><link rel="stylesheet" type="text/css" href="./example_files/m-front-mess.css"><link rel="stylesheet" type="text/css" href="./example_files/m-front-invite.css"><link type="text/css" rel="stylesheet" href="./example_files/m-webim-lite.css"><script type="text/javascript" language="javascript" id="BDBridgeReport" src="./example_files/Refresh.php" charset="UTF-8"></script></head>

<body onload="init();">
<center>
<table width="945" border="0" cellspacing="0" cellpadding="0">
  <tbody><tr>
    <td>
		
<style type="text/css">
<!--
.style111 {color: #3fc9bf}
.style222 {color: #3fc9bf}
-->
</style>



	<script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?419b2859637232430d667f0dbf27d370";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>



<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-2099323-4']);
  _gaq.push(['_setDomainName', 'youvivid.com']);
  _gaq.push(['_trackPageview']);

  (function() {
	var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
	var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>



<script type="text/javascript" src="./example_files/common.js"></script>
<script language="JavaScript" type="text/JavaScript">
<!--
function changeAction(){ 
	var a = document.form_lang.setlangid.value; 
	//alert(a);
	document.form_lang.action = 'http://' + a + '.youvivid.com/mobile_invite_edit.asp?invite_id=1534&previewid='; 
	document.form_lang.submit();
} 


function selectTemplate(){
  
  if (document.form_objid.objid_now.value.length == 0){
  
      alert('請選擇一個樣版。');
    
  }else{
    
      location.assign('preview_new.asp?objid=' + document.form_objid.objid_now.value);
  }
  
  
}


-->
</script>

<table width="945" border="0" cellpadding="0" cellspacing="5">
        <tbody><tr>
          <td width="100%"><div align="left">
              <table width="100%" border="0" cellpadding="0" cellspacing="0">
                <form name="form_lang" action="" method="post"></form>
                    <tbody><tr>
                      <td width="52%">
<!--                      
                        <div align="left">
                        <a href="../event/index.asp?focusid=youvivid3" class="link_menu" >→最新活動：回憶保鮮盒熱烈募集中，快來製作專屬保鮮盒，堆疊你獨家的回憶軌跡</a>
                        
                      </div>
-->         
                          <div id="scArea" style="height: 20px; overflow: hidden; ">

                          </div>                                            
             
                          </td>
                    
                      <td width="48%">


                        <div align="right">
<a href="http://cn.youvivid.com/%E5%BE%AE%E4%BF%A1%E8%AF%B7%E6%9F%AC%E6%89%8B%E6%9C%BA%E5%96%9C%E5%B8%96" class="link_menu">首页</a>  |  						
						
                                    
                          <a href="http://cn.youvivid.com/login.asp" class="link_01">登录</a> | <a href="http://cn.youvivid.com/usr_addnew.asp" class="link_01">免费注册</a>&nbsp;&nbsp;
          
                                    
                        </div></td>
        
        
      </tr>
                
    </tbody></table>		  
		  
	  
		  
            </div>
             
             
             
             

          </td>
        </tr>
		
</tbody></table>


<table width="947" border="0" cellspacing="0" cellpadding="0">
  <tbody><tr bgcolor="#000000">
    <td width="280" align="left" valign="top"><a href="http://cn.youvivid.com/%E5%BE%AE%E4%BF%A1%E8%AF%B7%E6%9F%AC%E6%89%8B%E6%9C%BA%E5%96%9C%E5%B8%96"><img src="./example_files/banner_start.jpg" alt="首页" title="首页" width="280" height="108" border="0"></a></td>


  <td width="100" valign="top">
    	<img src="./example_files/btn1_3_cn.jpg" width="100" height="108"></td>
    <td width="18" valign="top">
    	<img src="./example_files/banner_aro1.jpg" width="18" height="108"></td>
    <td width="106" valign="top">
		<img src="./example_files/btn2_1_cn.jpg" width="106" height="108" style="cursor: pointer;" onclick="javascript: saveNew(&#39;nextstep&#39;);" onmouseover="this.src=&#39;images/invite/btn2_2_cn.jpg&#39;" onmouseout="this.src=&#39;images/invite/btn2_1_cn.jpg&#39;"></td>
    <td width="20" valign="top">
		<img src="./example_files/banner_aro2.jpg" width="20" height="108"></td>
    <td width="108" valign="top">
		<img src="./example_files/btn3_1_cn.jpg" width="108" height="108"></td>


      
    <td width="315" align="left" valign="top"><img src="./example_files/banner_end.jpg" width="315" height="108"></td>
  </tr>
</tbody></table>






<script language="javascript">
<!--


  function openMenu(e){
        
        var mx, my;
        if (window.ActiveXObject){  
            mx = e.x; 
            my = e.y; 
        }else{
            mx = e.clientX; 
            my = e.clientY; 
        }    
        
        document.getElementById('_usrmenu').style.display = '';
        document.getElementById('_usrmenu').style.position = 'absolute';
        document.getElementById('_usrmenu').style.left = ( document.documentElement.scrollLeft + mx - 20) + 'px';
        document.getElementById('_usrmenu').style.top = ( document.documentElement.scrollTop + my  + 3 ) + 'px';
        
        
  }


  function closeMenu(){

               
        document.getElementById('_usrmenu').style.display = 'none';
        
        

  }

-->
</script>
    </td>
  </tr>
  <tr>
    <td>
  		<div id="tip4editor" style="height: 20px; overflow: hidden; ">
        </div>
    </td>
  </tr>
</tbody></table>  

<form action="http://cn.youvivid.com/mobile_invite_edit_act.asp" method="post" name="form_invite" id="form_invite">
<table width="945" border="0" cellspacing="0" cellpadding="0">

<input type="hidden" id="slideshow" name="slideshow" value="">
<input type="hidden" id="invite_detailidarray" name="invite_detailidarray" value="">
<input type="hidden" id="invite_act" name="invite_act" value="">
<input type="hidden" name="invite_id" value="1534">
<input type="hidden" name="invite_bgcolor" value="#ffffff">
<input type="hidden" name="invite_color" value="#ff87c3">
<input type="hidden" name="invite_description" id="invite_description" value="">
  <tbody><tr>
    <td>
        <table width="100%" border="0" cellspacing="0" cellpadding="0">
          <tbody><tr>
            <td width="41%" valign="top">
                <div align="left" style=" padding-left:28px; padding-top:60px; background-image: url(&#39;images/mobile_invite/iphone4s_384x613.png&#39;); width: 384px; height: 613px; background-repeat: no-repeat;"><iframe id="iframepage" name="iframepage" allowtransparency="true" scrolling="auto" style="height: 485px; width: 327px; " src="invit.html" frameborder="0" marginwidth="0"></iframe></div>
					<script type="text/javascript">
                    // ipad iphone safari iframe problem
              			/*          
			  			$(function(){
                            if (/iPhone|iPod|iPad/.test(navigator.userAgent)) {
                            
                                $("#iframepage").bind("load",function() {
                                    var b = this.contentWindow.document.body;
                                    
                                    var div = $(document.createElement("div"));
                                    var divCSS = {
                                        'height' : 485,
                                        'width' : 327,
                                        'overflow' : 'scroll'
                                    }
                                    div.css(divCSS);
                                    
                                    // Move the body's children into this wrapper
                                    while (b.firstChild)
                                    {
                                        div.append(b.firstChild);
                                    }
                                    
                                    // Append the wrapper to the body
                                    $(b).append(div);
                                });
                            }
                        })
						*/
                    </script>
            
            </td>
            <td width="59%" align="left" valign="top">
            	<div id="accordion_header" class="ui-accordion ui-widget ui-helper-reset ui-accordion-icons" role="tablist">
                	<h3 id="header" class="ui-accordion-header ui-helper-reset ui-state-default ui-state-active ui-corner-top" role="tab" aria-expanded="true" aria-selected="true" tabindex="0"><span class="ui-icon ui-icon-triangle-1-s"></span><a href="#">&nbsp;&nbsp;主页设置</a></h3>
                    <div class="section-content ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content-active" role="tabpanel">
                        <div style="margin-left:20px">
    
            
                <table width="100%" border="0" cellpadding="2" cellspacing="1">
                  <tbody><tr>
                    <td align="right" valign="top" width="100">版　型:</td>
                    <td colspan="2" valign="top">
                    
                    <input type="hidden" name="invite_bmapbaidu" id="invite_bmapbaidu" value="1">
                    <input type="hidden" name="invite_stylename" id="invite_stylename" value="桃紅典雅">
                    <input type="hidden" name="invite_styleid" id="invite_styleid" value="26">
                    <input type="hidden" name="invite_fontname" id="invite_fontname" value="粗钢笔">
                    
                    <select id="invite_style">
                    
                    
                      <option value="css/mini/jquery-ui-1.8.20.custom.empty.css|css/mini/images/icons/|css/mini/custom.css|1|26" selected="selected">桃红典雅</option>
                    
                    
                      <option value="css/annie_pink/jquery-ui-1.8.20.custom.empty.css|css/annie_pink/images/icons/|css/annie_pink/custom.css|0|27">粉红浪漫</option>
                    
                    
                      <option value="css/taiwan/jquery-ui-1.8.20.custom.empty.css|css/taiwan/images/icons/|css/taiwan/custom.css|0|25">正港台味</option>
                    
                    
                      <option value="css/mini_ticket/jquery-ui-1.8.20.custom.empty.css|css/mini_ticket/images/icons/|css/mini_ticket/custom.css|0|24">入场卷</option>
                    
                    
                      <option value="css/annie_golden/jquery-ui-1.8.20.custom.empty.css|css/annie_golden/images/icons/|css/annie_golden/custom.css|1|31">金色永恒</option>
                    
                    
                      <option value="css/annie_blue/jquery-ui-1.8.20.custom.empty.css|css/annie_blue/images/icons/|css/annie_blue/custom.css|1|29">蓝色梦幻</option>
                    
                    
                      <option value="css/flower/jquery-ui-1.8.20.custom.empty.css|css/flower/images/icons/|css/flower/custom.css|1|30">雅致古风</option>

                    </select>


                    <label for="invite_fontface">&nbsp;&nbsp;字　型: </label>
                    <select id="invite_fontface">
                    
                      <option value="粗钢笔2,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial|http://tw.youvivid.com:8080/Fonts/getcss?family=%E7%B2%97%E9%92%A2%E7%AC%942&amp;font=%E7%B2%97%E9%92%A2%E7%AC%94|1|1" selected="selected">粗钢笔</option>
                    
                      <option value="黑体2,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial|http://tw.youvivid.com:8080/Fonts/getcss?family=%E9%BB%91%E4%BD%932&amp;font=%E9%BB%91%E4%BD%93|1|1">黑体</option>
                    
                      <option value="粗行楷体2,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial|http://tw.youvivid.com:8080/Fonts/getcss?family=%E7%B2%97%E8%A1%8C%E6%A5%B7%E4%BD%932&amp;font=%E7%B2%97%E8%A1%8C%E6%A5%B7%E4%BD%93|1|1">粗行楷体</option>
                    
                      <option value="甜妞体2,微软雅黑,宋体 Microsoft JhengHei,Microsoft YaHei,arial|http://tw.youvivid.com:8080/Fonts/getcss?family=%E7%94%9C%E5%A6%9E%E4%BD%932&amp;font=%E7%94%9C%E5%A6%9E%E4%BD%93|1|1">甜妞体</option>

                    </select>
                    
                    </td>
                  </tr>
                  <tr>
                    <td align="right" valign="top">主标题:</td>
                    <td colspan="2" valign="top">
                    
                    <input type="hidden" id="maintitlehtml" name="maintitlehtml" value="&lt;span style=&#39;text-decoration: none; font-style: normal; font-size: 20px; font-weight: normal; &#39;&gt;{新郎}与{新娘}婚宴邀约&lt;/span&gt;">
                    <input type="text" id="invite_maintitle" name="invite_maintitle" value="{新郎}与{新娘}婚宴邀约" size="35">
                    <img id="maintitlehtmlbold" src="./example_files/bold.gif" border="0" style="cursor:pointer;" onclick="doBold(&#39;maintitlehtml&#39;);" align="absmiddle">
                    <img id="maintitlehtmlitalic" src="./example_files/italic.gif" border="0" style="cursor:pointer;" onclick="doItalic(&#39;maintitlehtml&#39;);" align="absmiddle"> 
                    <img id="maintitlehtmlunderline" src="./example_files/underline.gif" border="0" style="cursor:pointer;" onclick="doUnderline(&#39;maintitlehtml&#39;);" align="absmiddle">
              		  <select id="selSize1" name="selSize1" onchange="doFontSize(&#39;maintitlehtml&#39;, this.options[this.selectedIndex].value)">
              		    <option value="8">8</option>
              		    <option value="9">9</option>
              		    <option value="10">10</option>
              		    <option value="11">11</option>
              		    <option value="12">12</option>
              		    <option value="14">14</option>
              		    <option value="16">16</option>
              		    <option value="18">18</option>
              		    <option value="20">20</option>
              		    <option value="22">22</option>
              		    <option value="24">24</option>
              		    <option value="26">26</option>
              		    <option value="28">28</option>
              		    <option value="30">30</option>
              		    <option value="32">32</option>
              		    <option value="36">36</option>
              		    <option value="40">40</option>
              		    <option value="44">44</option>
              		    <option value="48">48</option>
              		    <option value="52">52</option>
              		  </select>                     
                    
                    </td>
                  </tr>
                  <tr>
                    <td width="55" align="right" valign="top">封面图: </td>
                    <td width="100" valign="top">
	                    <img src="./example_files/f1302065111bb40c28cc.jpg" width="100" align="top" id="invite_webimg">
                        <input type="hidden" id="invite_webimgurl" name="invite_webimgurl" value="http://youvividcnupload1.oss.aliyuncs.com/images/2013/7/f1302065111bb40c28cc.jpg" size="40"> 
                        <input type="hidden" name="invite_mediatype" id="invite_mediatype" value="0">
                    </td>
                    <td width="367" valign="top"><input id="select_image" name="select_image" type="button" value="选择图片"></td>
                  </tr>
                  <tr>
                    <td align="right" valign="top">MV视频:</td>
                    <td valign="top">
                        
                        	<img id="video_selected" style=" cursor:pointer;" src="./example_files/select_your_mv.jpg" width="100" align="top">
                        <span id="invite_previewname"> <font color="#FF66FF">尚未选取MV视频</font></span>                	
                        <input type="hidden" name="invite_previewid" id="invite_previewid" value="0">
					</td>
                    <td valign="top">
                        <input id="select_video" name="select_video" type="button" value="选择MV">
                        <input id="remove_video" name="remove_video" type="button" disabled="disabled" value="移除MV">
                    </td>
                  </tr>
                  <tr>
                    <td align="right" valign="top">副标题:</td>
                    <td colspan="2" valign="top">

                  <input type="hidden" id="subtitlehtml" name="subtitlehtml" value="&lt;span style=&#39;font-weight: normal; font-size: 18px; &#39;&gt;{宴客日期}&lt;/span&gt;">
                  <input type="text" id="invite_subtitle" name="invite_subtitle" value="{宴客日期}" size="35">
                    <img id="subtitlehtmlbold" src="./example_files/bold.gif" border="0" style="cursor:pointer;" onclick="doBold(&#39;subtitlehtml&#39;);" align="absmiddle">
                    <img id="subtitlehtmlitalic" src="./example_files/italic.gif" border="0" style="cursor:pointer;" onclick="doItalic(&#39;subtitlehtml&#39;);" align="absmiddle">
                    <img id="subtitlehtmlunderline" src="./example_files/underline.gif" border="0" style="cursor:pointer;" onclick="doUnderline(&#39;subtitlehtml&#39;);" align="absmiddle">
              		  <select id="selSize2" name="selSize2" onchange="doFontSize(&#39;subtitlehtml&#39;, this.options[this.selectedIndex].value)">
              		    <option value="8">8</option>
              		    <option value="9">9</option>
              		    <option value="10">10</option>
              		    <option value="11">11</option>
              		    <option value="12">12</option>
              		    <option value="14">14</option>
              		    <option value="16">16</option>
              		    <option value="18">18</option>
              		    <option value="20">20</option>
              		    <option value="22">22</option>
              		    <option value="24">24</option>
              		    <option value="26">26</option>
              		    <option value="28">28</option>
              		    <option value="30">30</option>
              		    <option value="32">32</option>
              		    <option value="36">36</option>
              		    <option value="40">40</option>
              		    <option value="44">44</option>
              		    <option value="48">48</option>
              		    <option value="52">52</option>
              		  </select>                                       

                    </td>
                  </tr>
                </tbody></table>
        <script>
		
var $dialog_photo, $dialog_video;		
var temprnd=0;		
function reloadSelectVideoIframe(){
	temprnd = temprnd +1;
	var tail='?r='+ temprnd;
	var oldurl=document.getElementById('selectvideoframepage').src;
	var newurl = oldurl.split('?')[0] + tail;
	document.getElementById('selectvideoframepage').src=newurl;
	//alert('reload url:' + newurl);
}
		
$(document).ready(function() { 
		
		$("#invite_maintitle").bind('change keydown keyup paste input propertychange',function (){
			$('#iframepage').contents().find("#maintitlehtml").find("span:eq(0)").html($(this).val()); 
			setHiddenHtml('maintitlehtml');
		});


		//test webfont
		//$("#invite_maintitle").bind('keyup',function (){
		//	//"http://fonts.googleapis.com/css?family=Inconsolata&text=ABC"
		//	var webfonturl = $('#iframepage').contents().find(".fontcss").attr("href");
		//	var newwebfonturl = webfonturl.split('&')[0] + '&text=' + escape($(this).val());
		//	$('#iframepage').contents().find(".fontcss").attr("href",newwebfonturl);
		//});

		$("#invite_maintitle").bind('focus',function (){
			 $('#iframepage').contents().find('html, body').animate({scrollTop: 0});
			//$('#iframepage').animate({ scrollTop: 30 }, "slow");
			//$('#iframepage').contents().animate({ scrollTop: $(document).height() }, "slow");
		});
		$("#invite_subtitle").bind('change keydown keyup paste input propertychange',function (){
			$('#iframepage').contents().find("#subtitlehtml").find("span:eq(0)").html($(this).val()); 
			setHiddenHtml('subtitlehtml');
			
		 // alert('Handler for .change() called.');
		});
		$("#invite_subtitle").bind('focus',function (){
			 $('#iframepage').contents().find('html, body').animate({scrollTop: 0});
			//$('#iframepage').animate({ scrollTop: 30 }, "slow");
			//$('#iframepage').contents().animate({ scrollTop: $(document).height() }, "slow");
		});
		
		$("#select_image").bind('click', function (e) {
			//alert("select_image");
			e.preventDefault();
			$('#iframepage').contents().find('html, body').animate({scrollTop: 0});
			var page = 'mobile_invite_select_photo_header.asp';
			var pagetitle = '请选择作为封面的相片';
			$dialog_photo = $('<div></div>')
			.html('<iframe frameborder="0" border="0" cellspacing="0" style="border: none; " src="' + page + '" width="100%" height="100%"></iframe>')
			.dialog({
				autoOpen: false,
				modal: false,
				//position: "right",
				width: 580,
				height: 610,
				title: pagetitle,
				buttons: {
					关闭: function() {
                         $( this ).dialog( "close" );
						}
				}
			});
			$dialog_photo.dialog('open');




			//$('#title_editor').elrte('val', $('#iframepage').contents().find("#title").html() );
			//$('#title_editor').elrte('updateSource');
		});




		$("#select_video").bind('click', function (e) {
			//alert("select_image");
			e.preventDefault();
			$('#iframepage').contents().find('html, body').animate({scrollTop: 0});
			var page = 'mobile_invite_select_video_header.asp';
			var pagetitle = '请选择MV视频';
			$dialog_video = $('<div></div>')
			.html('<input value="制作新MV" type="button" onClick="window.open(\'/create_mv.asp?asid=123\');" />   <input value="重新载入" type="button" onClick="reloadSelectVideoIframe();" /> <span style="color: #ff9900;">为尊重著作财产权, 喜讯中播放MV时将自动使用模板预置音乐</span><br/> <br><br><iframe id="selectvideoframepage" frameborder="0" border="0" cellspacing="0"  style="border: none; " src="' + page + '" width="510" height="500"></iframe>')
			.dialog({
				autoOpen: false,
				modal: false,
				//position: "right",
				height: 610,
				width: 580,
				title: pagetitle,
				buttons: {
					关闭: function() {
                         $( this ).dialog( "close" );
						}
				}
			});
			$dialog_video.dialog('open');




			//$('#title_editor').elrte('val', $('#iframepage').contents().find("#title").html() );
			//$('#title_editor').elrte('updateSource');
		});

		$("#remove_video").bind('click', function (e) {
			$('#iframepage').get(0).contentWindow.invite_mediatype=0;
			$("#iframepage").contents().find('#img_videobutton').hide();
			$("#iframepage").contents().find('#img_videobutton_placeholder').hide();
			//$("#iframepage").contents().find('#invite_webimg,#img_decoration1,#img_decoration2,#img_decoration3').css('cursor', 'default');


			$('#invite_previewid').val(0);
			$("#invite_mediatype").val(0);
			//$('#video_selected').hide();
			$('#invite_previewname').html('<font color="#FF66FF">尚未选取MV视频</font>');
			$("#remove_video").attr("disabled", true);
			$('#video_selected').attr('src', 'images/select_your_mv.jpg');
			alert("移除MV视频完成");

			
		});

		$("#video_selected").bind('click', function (e) {
			if ($('#invite_previewid').val() == 0) {
				$("#select_video").click();
			} else {
				alert("请点手机封面图左下角的图标以播放MV视频");
			}

			
		});
		
		
		
		
		
		

});
		
		</script>


<!--
                <a id="load_title" href="#" >LOAD</a> <br>
                <a id="save_title" href="#" >SAVE</a>





-->
    
                      </div>
                    </div>
                   </div>
            	
            	<div id="accordion_detail" class="ui-accordion ui-widget ui-helper-reset ui-accordion-icons" role="tablist">
				   <h3 class="ui-accordion-header ui-helper-reset ui-state-default ui-state-active ui-corner-top" role="tab" aria-expanded="true" aria-selected="true" tabindex="0"><span class="ui-icon ui-icon-triangle-1-s"></span><a href="#">&nbsp;&nbsp;子页编辑 <span style=" color:#CCC">(请点选下方页签)</span></a></h3>
                   <div class="section-content ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content-active" role="tabpanel">

<div class="ui-widget">

<div id="tabs" class="ui-tabs ui-widget ui-widget-content ui-corner-all">
	<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all ui-sortable">


		<li id="7042" class="ui-state-default ui-corner-top"><a id="invite_detail_title7042" href="#invite_detail_content7042">
        
                <input class="tab_name tab_name_idle" type="text" id="invite_detail_name7042" name="invite_detail_name7042" value="爱的邀约" size="7">
        </a></li>
        <script>
		$("#invite_detail_name7042").bind('change keydown keyup paste input propertychange',function () {
			$('#iframepage').contents().find("#invite_detail_name7042").text($(this).val()); 
			
		 // alert('Handler for .change() called.');
		});
		</script>


		<li id="7041" class="ui-state-default ui-corner-top"><a id="invite_detail_title7041" href="#invite_detail_content7041">
        
                <input class="tab_name tab_name_idle" type="text" id="invite_detail_name7041" name="invite_detail_name7041" value="婚纱相册" size="7">
        </a></li>
        <script>
		$("#invite_detail_name7041").bind('change keydown keyup paste input propertychange',function () {
			$('#iframepage').contents().find("#invite_detail_name7041").text($(this).val()); 
			
		 // alert('Handler for .change() called.');
		});
		</script>


		<li id="7043" class="ui-state-default ui-corner-top"><a id="invite_detail_title7043" href="#invite_detail_content7043">
        
                <input class="tab_name tab_name_idle" type="text" id="invite_detail_name7043" name="invite_detail_name7043" value="婚宴回函" size="7">
        </a></li>
        <script>
		$("#invite_detail_name7043").bind('change keydown keyup paste input propertychange',function () {
			$('#iframepage').contents().find("#invite_detail_name7043").text($(this).val()); 
			
		 // alert('Handler for .change() called.');
		});
		</script>


		<li id="7044" class="ui-state-default ui-corner-top"><a id="invite_detail_title7044" href="#invite_detail_content7044">
        
                <input class="tab_name tab_name_idle" type="text" id="invite_detail_name7044" name="invite_detail_name7044" value="婚宴地图" size="7">
        </a></li>
        <script>
		$("#invite_detail_name7044").bind('change keydown keyup paste input propertychange',function () {
			$('#iframepage').contents().find("#invite_detail_name7044").text($(this).val()); 
			
		 // alert('Handler for .change() called.');
		});
		</script>


		<li id="7046" class="ui-state-default ui-corner-top"><a id="invite_detail_title7046" href="#invite_detail_content7046">
        
                <input class="tab_name tab_name_idle" type="text" id="invite_detail_name7046" name="invite_detail_name7046" value="喜宴提醒" size="7">
        </a></li>
        <script>
		$("#invite_detail_name7046").bind('change keydown keyup paste input propertychange',function () {
			$('#iframepage').contents().find("#invite_detail_name7046").text($(this).val()); 
			
		 // alert('Handler for .change() called.');
		});
		</script>


		<li id="7045" class="ui-state-default ui-corner-top"><a id="invite_detail_title7045" href="#invite_detail_content7045">
        
                <input class="tab_name tab_name_idle" type="text" id="invite_detail_name7045" name="invite_detail_name7045" value="喜讯分享" size="7">
        </a></li>
        <script>
		$("#invite_detail_name7045").bind('change keydown keyup paste input propertychange',function () {
			$('#iframepage').contents().find("#invite_detail_name7045").text($(this).val()); 
			
		 // alert('Handler for .change() called.');
		});
		</script>

	</ul>









	<div id="invite_detail_content7042" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide">
		<div align="right">
        	<input name="invite_detail_id" id="invite_detail_id" type="hidden" value="7042">
            <input name="invite_detail_type" id="invite_detail_type" type="hidden" value="1">
            <input name="bshow7042" type="checkbox" id="bshow7042" value="0">隐藏 
        </div>
		<script>
		$(document).ready(function() {
			//set initial state.
			
			$('#bshow7042').change(function() {
				if ($(this).is(':checked')) {
         			//alert('hide');
					
					//$("#invite_detail_name7042").attr("disabled",true);
					$("#invite_detail_name7042").addClass("tab_name_hide");


					bshow7042 = 0
					$('#iframepage').contents().find("#invite_detail_title7042").hide();
					$('#iframepage').contents().find("#invite_detail_content7042").hide();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "activate" , false )
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } );
				} else {
         			//alert('show');
					//$("#invite_detail_name7042").attr("disabled",false);
					$("#invite_detail_name7042").removeClass("tab_name_hide");
					bshow7042 = 1;
					$('#iframepage').contents().find("#invite_detail_title7042").show();
					$('#iframepage').contents().find("#invite_detail_content7042").show();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } ).accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
				}
				$('#iframepage').get(0).contentWindow.processButtonBackground();	//call iframe function	 

			});
		});
 
        </script>

        	<input type="hidden" name="invite_detail_fontindex7042" id="invite_detail_fontindex7042" value="1">
			<div style="color:#C6593D"><img src="./example_files/info.gif" width="16" height="15"> 修改文字后,请点击工具列左侧 <img src="./example_files/reload2.png" width="10" height="10"> 按钮以刷新画面</div>
			<br>
			<textarea id="invite_detail_editor7042" name="invite_detail_editor7042" style="visibility: hidden; display: none;"></textarea><span id="cke_invite_detail_editor7042" class="cke_skin_kama cke_1 cke_editor_invite_detail_editor7042" dir="ltr" title="" lang="zh-cn" tabindex="0" role="application" aria-labelledby="cke_invite_detail_editor7042_arialbl"><span id="cke_invite_detail_editor7042_arialbl" class="cke_voice_label">所见即所得编辑器</span><span class="cke_browser_webkit" role="presentation"><span class="cke_wrapper cke_ltr" role="presentation"><table class="cke_editor" border="0" cellspacing="0" cellpadding="0" role="presentation"><tbody><tr role="presentation"><td id="cke_top_invite_detail_editor7042" class="cke_top" role="presentation"><div class="cke_toolbox" role="group" aria-labelledby="cke_5" onmousedown="return false;"><span id="cke_5" class="cke_voice_label">工具栏</span><span id="cke_6" class="cke_toolbar" aria-labelledby="cke_6_label" role="toolbar"><span id="cke_6_label" class="cke_voice_label">font face</span><span class="cke_toolbar_start"></span><span class="cke_toolgroup" role="presentation"><span class="cke_button"><a id="cke_7" class="cke_off cke_button_reloadWebFont" "="" href="javascript:void('重新載入字型')" title="重新載入字型" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_7_label" onkeydown="return CKEDITOR.tools.callFunction(1, event);" onfocus="return CKEDITOR.tools.callFunction(2, event);" onclick="CKEDITOR.tools.callFunction(3, this); return false;"><span class="cke_icon" style="background-image:url(http://cn.youvivid.com/ckeditor/plugins/reloadwebfont/reload2.png?t=B8DJ5M3);background-position:0 0px;">&nbsp;</span><span id="cke_7_label" class="cke_label">重新載入字型</span></a></span></span><span class="cke_rcombo" role="presentation"><span id="cke_8" class="cke_font cke_off" role="presentation"><span id="cke_8_label" class="cke_label">字体</span><a hidefocus="true" title="字体" tabindex="-1" href="javascript:void('字体')" role="button" aria-labelledby="cke_8_label" aria-describedby="cke_8_text" aria-haspopup="true" onkeydown="CKEDITOR.tools.callFunction( 5, event, this );" onfocus="return CKEDITOR.tools.callFunction(6, event);" onclick="CKEDITOR.tools.callFunction(4, this); return false;"><span><span id="cke_8_text" class="cke_text cke_inline_label">字体</span></span><span class="cke_openbutton"><span class="cke_icon"></span></span></a></span></span><span class="cke_rcombo" role="presentation"><span id="cke_9" class="cke_fontSize cke_off" role="presentation"><span id="cke_9_label" class="cke_label">大小</span><a hidefocus="true" title="大小" tabindex="-1" href="javascript:void('大小')" role="button" aria-labelledby="cke_9_label" aria-describedby="cke_9_text" aria-haspopup="true" onkeydown="CKEDITOR.tools.callFunction( 8, event, this );" onfocus="return CKEDITOR.tools.callFunction(9, event);" onclick="CKEDITOR.tools.callFunction(7, this); return false;"><span><span id="cke_9_text" class="cke_text cke_inline_label">大小</span></span><span class="cke_openbutton"><span class="cke_icon"></span></span></a></span></span><span class="cke_toolbar_end"></span></span><span id="cke_10" class="cke_toolbar" aria-labelledby="cke_10_label" role="toolbar"><span id="cke_10_label" class="cke_voice_label">font type</span><span class="cke_toolbar_start"></span><span class="cke_toolgroup" role="presentation"><span class="cke_button"><a id="cke_11" class="cke_off cke_button_bold" "="" href="javascript:void('加粗')" title="加粗" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_11_label" onkeydown="return CKEDITOR.tools.callFunction(10, event);" onfocus="return CKEDITOR.tools.callFunction(11, event);" onclick="CKEDITOR.tools.callFunction(12, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_11_label" class="cke_label">加粗</span></a></span><span class="cke_button"><a id="cke_12" class="cke_off cke_button_italic" "="" href="javascript:void('倾斜')" title="倾斜" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_12_label" onkeydown="return CKEDITOR.tools.callFunction(13, event);" onfocus="return CKEDITOR.tools.callFunction(14, event);" onclick="CKEDITOR.tools.callFunction(15, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_12_label" class="cke_label">倾斜</span></a></span><span class="cke_button"><a id="cke_13" class="cke_off cke_button_textcolor" "="" href="javascript:void('文本颜色')" title="文本颜色" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_13_label" aria-haspopup="true" onkeydown="return CKEDITOR.tools.callFunction(16, event);" onfocus="return CKEDITOR.tools.callFunction(17, event);" onclick="CKEDITOR.tools.callFunction(18, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_13_label" class="cke_label">文本颜色</span><span class="cke_buttonarrow">&nbsp;</span></a></span><span class="cke_button"><a id="cke_14" class="cke_off cke_button_bgcolor" "="" href="javascript:void('背景颜色')" title="背景颜色" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_14_label" aria-haspopup="true" onkeydown="return CKEDITOR.tools.callFunction(19, event);" onfocus="return CKEDITOR.tools.callFunction(20, event);" onclick="CKEDITOR.tools.callFunction(21, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_14_label" class="cke_label">背景颜色</span><span class="cke_buttonarrow">&nbsp;</span></a></span></span><span class="cke_toolbar_end"></span></span><span id="cke_15" class="cke_toolbar" aria-labelledby="cke_15_label" role="toolbar"><span id="cke_15_label" class="cke_voice_label">段落</span><span class="cke_toolbar_start"></span><span class="cke_toolgroup" role="presentation"><span class="cke_button"><a id="cke_16" class="cke_off cke_button_justifyleft" "="" href="javascript:void('左对齐')" title="左对齐" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_16_label" onkeydown="return CKEDITOR.tools.callFunction(22, event);" onfocus="return CKEDITOR.tools.callFunction(23, event);" onclick="CKEDITOR.tools.callFunction(24, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_16_label" class="cke_label">左对齐</span></a></span><span class="cke_button"><a id="cke_17" class="cke_off cke_button_justifycenter" "="" href="javascript:void('居中')" title="居中" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_17_label" onkeydown="return CKEDITOR.tools.callFunction(25, event);" onfocus="return CKEDITOR.tools.callFunction(26, event);" onclick="CKEDITOR.tools.callFunction(27, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_17_label" class="cke_label">居中</span></a></span><span class="cke_button"><a id="cke_18" class="cke_off cke_button_justifyright" "="" href="javascript:void('右对齐')" title="右对齐" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_18_label" onkeydown="return CKEDITOR.tools.callFunction(28, event);" onfocus="return CKEDITOR.tools.callFunction(29, event);" onclick="CKEDITOR.tools.callFunction(30, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_18_label" class="cke_label">右对齐</span></a></span></span><span class="cke_toolbar_end"></span></span></div></td></tr><tr role="presentation"><td id="cke_contents_invite_detail_editor7042" class="cke_contents" style="height:350px" role="presentation"><iframe style="width:100%;height:100%" frameborder="0" title="所见即所得编辑器, invite_detail_editor7042, 按 ALT+0 查看帮助。" src="" tabindex="-1" allowtransparency="true"></iframe></td></tr><tr style="display:none" role="presentation"><td id="cke_bottom_invite_detail_editor7042" class="cke_bottom" role="presentation"></td></tr></tbody></table><style>.cke_skin_kama{visibility:hidden;}</style></span></span></span>
			<script type="text/javascript">
			//no use now			
			function striphtml(html)
			{
			   var tmp = document.createElement("DIV");
			   tmp.innerHTML = html;
			   return tmp.textContent||tmp.innerText;
			}			


			//?建求XMLHttpRequest?象
			function createRequest() {
				try {
					request = new XMLHttpRequest();
				} catch (trymicrosoft) {
					try {
						request = new ActiveXObject("Msxml2.XMLHTTP");
					} catch (othermicrosoft) {
						try {
							request = new ActiveXObject("Microsoft.XMLHTTP");
						} catch (failed) {
							request = false;
						}
					}
				}
				if (!request)
					alert("ERROR XMLHttpRequest!");
			}
			
			
			
			var ck_editor;
			var contentcss_array =new Array();


			var webfontinfo_array = ['粗钢笔|粗钢笔1|http://tw.youvivid.com:8080/Fonts/csslink?family=%E7%B2%97%E9%92%A2%E7%AC%941&font=%E7%B2%97%E9%92%A2%E7%AC%94|2','黑体|黑体1|http://tw.youvivid.com:8080/Fonts/csslink?family=%E9%BB%91%E4%BD%931&font=%E9%BB%91%E4%BD%93|2','粗行楷体|粗行楷体1|http://tw.youvivid.com:8080/Fonts/csslink?family=%E7%B2%97%E8%A1%8C%E6%A5%B7%E4%BD%931&font=%E7%B2%97%E8%A1%8C%E6%A5%B7%E4%BD%93|2','甜妞体|甜妞体1|http://tw.youvivid.com:8080/Fonts/csslink?family=%E7%94%9C%E5%A6%9E%E4%BD%931&font=%E7%94%9C%E5%A6%9E%E4%BD%93|2'];


//["Google Inconsolata|Inconsolata|http://fonts.googleapis.com/css?family=Inconsolata|1", "粗鋼筆|粗鋼筆1|http://176.34.27.47:8080/Fonts/csslink?family=%E7%B2%97%E9%8B%BC%E7%AD%861&font=%E7%B2%97%E9%8B%BC%E7%AD%86|2", "隸書|隸書1|http://176.34.27.47:8080/Fonts/csslink?family=%E9%9A%B8%E6%9B%B81&font=%E9%9A%B8%E6%9B%B8|2", "粗行楷|粗行楷1|http://176.34.27.47:8080/Fonts/csslink?family=%E7%B2%97%E8%A1%8C%E6%A5%B71&font=%E7%B2%97%E8%A1%8C%E6%A5%B7|2", "甜妞體|甜妞體1|http://176.34.27.47:8080/Fonts/csslink?family=%E7%94%9C%E5%A6%9E%E9%AB%941&font=%E7%94%9C%E5%A6%9E%E9%AB%94|2", "粗仿宋|粗仿宋1|http://176.34.27.47:8080/Fonts/csslink?family=%E7%B2%97%E4%BB%BF%E5%AE%8B1&font=%E7%B2%97%E4%BB%BF%E5%AE%8B|2"]
	        $(function() { //jquery functiom

/*
CKEDITOR.on('instanceCreated', function(e) {
        e.editor.on('contentDom', function() {
            e.editor.document.on('keyup', function(event) {
                // keyup event in ckeditor
				alert("keyup");
            }
        );
    });
});
*/ 				





/*
				invite_detail_editor7042.on( 'instanceCreated', function( e ){
					//e.editor.addCss("@font-face {font-family: 'Tangerine';font-style: normal;font-weight:400;src:url(http://themes.googleusercontent.com/licensed/font?kit=HGfsyCL5WASpHOFnouG-RDw3lq_tDwQ_W1XLnKnCySHeam1auK8SK-P0IDuNkGpvlC5Ry6B6mVmboR_qwiqWMwwpq1i_o5Jh0TdhAqbWX8OjyKp-iBf-P5SHSRJRZlBjJlswdPUGqVXSTQd916Yg072EluW-Xo2w40ZED5zk1lSlErSxjd0WakWW3T9moeeH);src:local('Tangerine'),url(http://themes.googleusercontent.com/licensed/font?kit=HGfsyCL5WASpHOFnouG-RDw3lq_tDwQ_W1XLnKnCySHeam1auK8SK-P0IDuNkGpvlC5Ry6B6mVmboR_qwiqWMwwpq1i_o5Jh0TdhAqbWX8OjyKp-iBf-P5SHSRJRZlBjJlswdPUGqVXSTQd916Yg072EluW-Xo2w40ZED5zk1lSlErSxjd0WakWW3T9moeeH)format('embedded-opentype'),url(http://themes.googleusercontent.com/licensed/font?kit=HGfsyCL5WASpHOFnouG-ROV6CW0QezKDeHJJu5DWZvXeam1auK8SK-P0IDuNkGpvlC5Ry6B6mVmboR_qwiqWMwwpq1i_o5Jh0TdhAqbWX8OjyKp-iBf-P5SHSRJRZlBjJlswdPUGqVXSTQd916Yg072EluW-Xo2w40ZED5zk1lSlErSxjd0WakWW3T9moeeH)format('woff');}");
				});
*/




			function   familyParser(text) {
				var familyArray = [];
				var textArray = [] ;
				var tagArray = [];
				var parser = new CKEDITOR.htmlParser();
				var font = null;
			
				parser.onText = function (text) {
					if (font == null) return;
					var indexS = font.indexOf('font-family:');
					var indexE1 = font.indexOf(',', indexS); // -1 , n
					var indexE2 = font.indexOf(';', indexS); // -1 , n
					if (indexE1 == -1 )
						indexE1 = font.length;
					if (indexE2 == -1 )
						indexE2 = font.length;
					indexE = Math.min(indexE1,indexE2);
					
					
					
					var fontName = font.substring(indexS + 12, indexE).trim().ReplaceAll("'", "").ReplaceAll('"', '');
					var bFound = false;
					for (var i = familyArray.length - 1; i >= 0; i--) {
						if (familyArray[i].localeCompare(fontName) == 0) {
							textArray[i] += text;
							bFound = true;
							break;
						}
					}
			
					if (bFound == false) {
						familyArray.push(fontName);
						textArray.push(text);
					}
				}
			
				parser.onTagClose = function (tagName) {
					tag = tagArray.pop();
					if (tag == null) return;
					if (tag.indexOf("font-family") != -1) {
						for (i = tagArray.length - 1; i >= 0; i--) {
							if (tagArray[i] == null) continue;
							if (tagArray[i].indexOf("font-family") != -1) {
								font = tagArray[i];
								return;
							}
						}
					}
					//font = null;
				}
			
				parser.onTagOpen = function (tagName, attributes, selfClosing) {
					if ((attributes == null) || (attributes.style == null)) {
						tagArray.push(null);
						return;
					}
			
					tagArray.push(attributes.style);
					if (attributes.style.indexOf("font-family") != -1) {
						font = attributes.style;
					}
			
				};
			
				parser.parse(text);
				parser = null;
				return {family:familyArray, text:textArray};
			}


			CKEDITOR.on('instanceCreated', function(e) {

				htmltext =	e.editor.getData();

				// use familyParser instead
				//plaintext = e.editor.getData().replace( /(<[^<|>]+?>|\r\n|\n|\r|^\s*|\s*$|\s+|&nbsp;)/gim,'' );
				//plaintext_min = getMinTextInOrder(plaintext)

				var fontArray = familyParser( htmltext );
				//alert("fontArray.family.length=" + fontArray.family.length + ", fontArray.family ="+ fontArray.family);
				//alert(fontArray.text);

				//contentcss_list = "";
				
				contentcss_array[0] = '/ckeditor/contents.css';

				for ( cc=0; cc < webfontinfo_array.length ; cc++) {
					
					tmp_webfontname = webfontinfo_array[cc].split('|')[0];
					tmp_webfont = webfontinfo_array[cc].split('|')[1];
					tmp_webfonturl = webfontinfo_array[cc].split('|')[2];
					tmp_webfonttype = webfontinfo_array[cc].split('|')[3];
					
					//fontArray_idx = fontArray.family.indexOf(tmp_webfont.toLowerCase());
					//fontArray_idx = $.inArray(tmp_webfont.toLowerCase(), fontArray.family); 
					//alert(fontArray.family);
					
					var fontArray_idx = -1;
					
					for (var i = 0; i < fontArray.family.length; i++) {
					  if (fontArray.family[i].trim() == tmp_webfont.trim().toLowerCase()) {
						fontArray_idx = i;
						break;
					  }
					}
					
					
					
					
					
					//alert(tmp_webfont.toLowerCase() + ", fontArray_idx:" + fontArray_idx + ", font: " +  fontArray.family[fontArray_idx]+ ", text: " +  fontArray.text[fontArray_idx]+ ", " + fontArray.family );
					
					if ( fontArray_idx == -1 ){
						if (tmp_webfonttype==3 ) {
							contentcss_array[cc+1] = tmp_webfonturl; 
						} else {
							contentcss_array[cc+1] = "/ckeditor/empty.css"; 
						}
					} else {
						
						var_text = getMinTextInOrder(fontArray.text[fontArray_idx]);



						//if (  e.editor.getData().toUpperCase().indexOf(tmp_webfont.toUpperCase()) >= 0 ) {
						//	var_text = tmp_webfontname + plaintext_min;
						//}else{
						//	var_text = tmp_webfontname ;
						//}
						
								
						if (tmp_webfonttype==1 || tmp_webfonttype==3 ) {
							//contentcss_list = contentcss_list + "'" + tmp_webfonturl + "&text=" + encodeURIComponent(var_text) + "'," ; 
							// only google web font use this
							//contentcss_array[cc+1] = tmp_webfonturl + "&text=" + encodeURIComponent(var_text);
							contentcss_array[cc+1] = tmp_webfonturl; 
						//	console.log(contentcss_array[cc]);
							
						}else{
							new_webfont = tmp_webfont + $('#invite_detail_fontindex7042').val();
	
							post_url = tmp_webfonturl.split('?')[0];
							post_vars = tmp_webfonturl.split('?')[1] + "&text=" + encodeURIComponent(var_text);
		
							//console.log('tmp_webfont:' + tmp_webfont + ', new_webfont:' + new_webfont);
							//console.log('1:' + post_vars);
							post_vars=post_vars.ReplaceAll(tmp_webfont,new_webfont);
							post_vars=post_vars.ReplaceAll(encodeURIComponent(tmp_webfont),encodeURIComponent(new_webfont));
							//console.log('2:' + post_vars);
							
							
							createRequest();

							//post_url = "http://cn.youvivid.com/mobile_invite_getcontentcssurl.asp";
							//serverUrl = 'http://cn.youvivid.com/';
							//post_url = "http://" + serverUrl.split(/\/+/g)[1] + ":8080/Fonts/csslink";
							//alert(post_url);

							if($.browser.msie && parseInt($.browser.version, 10) <= 7) {
								post_url = "http://cn.youvivid.com/mobile_invite_getcontentcssurl.asp";
							} else {
								serverUrl = 'http://cn.youvivid.com/';
								post_url = "http://" + serverUrl.split(/\/+/g)[1] + ":8080/Fonts/csslink";
							}

							
							request.open("POST", post_url, false);
							
							request.setRequestHeader("Content-type","application/x-www-form-urlencoded");
						//	alert(post_url+"," + post_vars);
							request.send(post_vars);
							post_response = request.responseText; //?取服?器返回的JSON字串
						//	alert("post_response=" + post_response);
							// this is for testing 
							//contentcss_list = contentcss_list + "'" + tmp_webfonturl + "&text=" + encodeURIComponent(var_text) + "'," ; 
							//contentcss_array[cc] = tmp_webfonturl + "&text=" + encodeURIComponent(var_text);
							contentcss_array[cc+1] = post_response;
	
							//ex: http://176.34.27.47:8080/Fonts/getcss/88b676b2-ef25-4a41-98da-365bf8299d42;jsessionid=E7BD1CD3D9271040A72A5952BC4ED719?family=粗鋼筆 
							//contentcss_url_part1=post_response.split('?family=')[0];
							//contentcss_url_part2=post_response.split('?family=')[1];
							//contentcss_url = contentcss_url_part1 + '?family=' + encodeURIComponent(contentcss_url_part2);
							//contentcss_array[cc] = contentcss_url;
							//	console.log(contentcss_array[cc]);
	
							var reg = new RegExp( tmp_webfont + '\\d+' , 'gim');
							htmltext = htmltext.replace(reg, new_webfont);
							htmltext = htmltext.ReplaceAll(tmp_webfont +'_youvivid_dynamic_font',new_webfont);
						
						}
				
					} //if (fontArray.family.indexOf(tmp_webfont.toLowerCase) <> -1 ){
				} //for loop


				$('#invite_detail_fontindex7042').val( Number($('#invite_detail_fontindex7042').val())+1);
				//console.log(htmltext);
				//console.log(contentcss_array);
				//console.log('粗钢笔/粗钢笔1,粗钢笔1_youvivid_dynamic_font,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;黑体/黑体1,黑体1_youvivid_dynamic_font,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗行楷体/粗行楷体1,粗行楷体1_youvivid_dynamic_font,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;甜妞体/甜妞体1,甜妞体1_youvivid_dynamic_font,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;');
				
				
				e.editor.setData(htmltext);



			e.editor.addCommand( 'reloadWebFont',
			{
				exec : function( edr )
				{    
					htmltext2 =	edr.getData();

					//alert("reloadwebfont");
					//plaintext = edr.getData().replace( /(<[^<|>]+?>|\r\n|\n|\r|^\s*|\s*$|\s+|&nbsp;)/gim,'' );
					//plaintext_min = getMinTextInOrder(plaintext)
					//alert (plaintext_min);
		
					//1. update html

						cc = -1;
						//$(CKEDITOR.instances[i].document.$).find('link').each(function() {
						$(edr.document.$).find('link').each(function() {
							
							//bypass the first #webfontinfo_array.length css
							if (cc >= 0) {
								tmp_webfontname = webfontinfo_array[cc].split('|')[0];
								tmp_webfont = webfontinfo_array[cc].split('|')[1];
								tmp_webfonturl = webfontinfo_array[cc].split('|')[2];
								tmp_webfonttype = webfontinfo_array[cc].split('|')[3];
								
								if (tmp_webfonttype==1 || tmp_webfonttype==3) {
								}else{
									new_webfont = tmp_webfont + $('#invite_detail_fontindex7042').val();
									
									var reg = new RegExp( tmp_webfont + '\\d+' , 'gim');
									htmltext2 = htmltext2.replace(reg, new_webfont);
									htmltext2 = htmltext2.ReplaceAll(tmp_webfont+'_youvivid_dynamic_font',new_webfont);
								}
							} //if (cc>=0)
					
							cc=cc+1;
						
						
						});

//console.log(htmltext);
						$('#iframepage').contents().find("#invite_detail_editor7042").html(htmltext2);
						
						
						edr.setData(htmltext2, function(){
							//this.checkDirty();  // true

						//2. update csslink

							var fontArray = familyParser( htmltext2 );

//console.log(fontArray);

							cc = -1;
							//$(CKEDITOR.instances[i].document.$).find('link').each(function() {
							$(edr.document.$).find('link').each(function() {
								
								//bypass the first css

								if (cc>=0) {
									tmp_webfontname = webfontinfo_array[cc].split('|')[0];
									tmp_webfont = webfontinfo_array[cc].split('|')[1];
									tmp_webfonturl = webfontinfo_array[cc].split('|')[2];
									tmp_webfonttype = webfontinfo_array[cc].split('|')[3];
									

									//if (  edr.getData().toUpperCase().indexOf(tmp_webfont.toUpperCase()) >= 0 ) {
									//	var_text = tmp_webfontname + plaintext_min;
									//}else{
									//	var_text = tmp_webfontname ;
									//}
									//fontArray_idx = fontArray.family.indexOf(tmp_webfont.toLowerCase());

									fontArray_idx = -1;
									
									for (var i = 0; i < fontArray.family.length; i++) {
									  if (fontArray.family[i].trim() == tmp_webfont.toLowerCase()) {
										fontArray_idx = i;
										break;
									  }
									}
									
									//alert(tmp_webfont.toLowerCase() + ", fontArray_idx:" + fontArray_idx + ", font: " +  fontArray.family[fontArray_idx]+ ", text: " +  fontArray.text[fontArray_idx] );
									
									if ( fontArray_idx == -1 ){
										//nothing to do 
									} else {
										
										var_text = getMinTextInOrder(fontArray.text[fontArray_idx]);
	
										if (tmp_webfonttype==1 || tmp_webfonttype==3) {
											//new_css_url = tmp_webfonturl + "&text=" + encodeURIComponent(var_text);
											new_css_url = tmp_webfonturl ;
		
										}else{
											new_webfont = tmp_webfont + $('#invite_detail_fontindex7042').val();
											
											post_url = tmp_webfonturl.split('?')[0];
											post_vars = tmp_webfonturl.split('?')[1] + "&text=" + encodeURIComponent(var_text);
	
											post_vars=post_vars.ReplaceAll(tmp_webfont,new_webfont);
											post_vars=post_vars.ReplaceAll(encodeURIComponent(tmp_webfont),encodeURIComponent(new_webfont));
	
											createRequest();

											//post_url = "http://cn.youvivid.com/mobile_invite_getcontentcssurl.asp";
											//serverUrl = 'http://cn.youvivid.com/';
											//post_url = "http://" + serverUrl.split(/\/+/g)[1] + ":8080/Fonts/csslink";
											//alert(post_url);
											if($.browser.msie && parseInt($.browser.version, 10) <= 7) {
												post_url = "http://cn.youvivid.com/mobile_invite_getcontentcssurl.asp";
											} else {
												serverUrl = 'http://cn.youvivid.com/';
												post_url = "http://" + serverUrl.split(/\/+/g)[1] + ":8080/Fonts/csslink";
											}
											request.open("POST", post_url, false);
											request.setRequestHeader("Content-type","application/x-www-form-urlencoded");
										//	alert(post_url+"," + post_vars);
											request.send(post_vars);
											post_response = request.responseText; //?取服?器返回的JSON字串
										//	alert("post_response=" + post_response);
											// this is for testing 
											//new_css_url = tmp_webfonturl + "&text=" + encodeURIComponent(var_text);
											new_css_url = post_response;
											
											//ex: http://176.34.27.47:8080/Fonts/getcss/88b676b2-ef25-4a41-98da-365bf8299d42;jsessionid=E7BD1CD3D9271040A72A5952BC4ED719?family=粗鋼筆 
											//contentcss_url_part1=post_response.split('?family=')[0];
											//contentcss_url_part2=post_response.split('?family=')[1];
											//contentcss_url = contentcss_url_part1 + '?family=' + encodeURIComponent(contentcss_url_part2);
											//new_css_url =  contentcss_url;
											
							//console.log('tmp_webfont:' + tmp_webfont + ', new_webfont:' + new_webfont);
							//				var reg = new RegExp( tmp_webfont + '\\d+' , 'gim');
							//				htmltext = htmltext.replace(reg, new_webfont);
										}
		
										
									//	alert(new_css_url);
									//	console.log(new_css_url + ", id=" + tmp_webfont);
										$('#iframepage').contents().find("#" + tmp_webfont ).attr('href', new_css_url )
										
										
										$(this).attr('href', new_css_url );
									}//( fontArray_idx == -1 ){
								} //if (cc>=0)
						
								cc=cc+1;
							
							
							});
							// useless below
							//ev.editor.config.font_names = 'Inconsolata/Inconsolata; 粗鋼筆/粗鋼筆, 微軟正黑體';
							//CKEDITOR.config.font_names = 'Inconsolata/Inconsolata; 粗鋼筆/粗鋼筆, 微軟正黑體';
							$('#invite_detail_fontindex7042').val(Number($('#invite_detail_fontindex7042').val())+1);
		

						});//edr.setData(htmltext2, function(){






				},
			    async : true //FIREFOX NEED THIS
			}); //end of e.editor.addCommand( 'reloadWebFont',





				//onchange plugin event
				e.editor.on( 'change', function(ev) { 
					

			
					htmltext =	ev.editor.getData();
					$('#iframepage').contents().find("#invite_detail_editor7042").html(htmltext);
						
					if (htmltext.indexOf('_youvivid_dynamic_font')!= -1) {	

						//delay(function(){
							ev.editor.execCommand( 'reloadWebFont');
						//},1000);

					} //if (htmltext.indexOf('_youvivid_dynamic_font')!= -1) {	
				

				});
				
			}); //CKEDITOR.on('instanceCreated', function(e) 
				

			var invite_detail_editor7042 = CKEDITOR.replace( 'invite_detail_editor7042',
			{
				extraPlugins : 'onchange,reloadwebfont', 
				toolbar :
				[
					
					{ name: 'font face', items : ['reloadWebFont','Font','FontSize' ] }, //source cause problem for access document in change event
					
					//{ name: 'font face', items : [ 'Source','Font','FontSize' ] }, //source cause problem for access document in change event
					//{ name: 'font face', items : [ 'Font','FontSize' ] },
					{ name: 'font type', items : [ 'Bold','Italic','TextColor','BGColor' ] },
					{ name: 'paragraph', items : [ 'JustifyLeft','JustifyCenter','JustifyRight' ] }
				],
				startupShowBorders : false,
				resize_enabled : false,
				toolbarCanCollapse : false,
				toolbarStartupExpanded : true,
				height: 350,
				//skin : 'office2003',
				skin : 'kama',
				language : 'zh-cn',
				//skin : 'v2',
				
				// use inline config instead
				//customConfig : '/ckeditor/config_leo.js'
				//enterMode : CKEDITOR.ENTER_BR,
				enterMode : CKEDITOR.ENTER_P,
				//font_names : 'Inconsolata/Inconsolata; 粗鋼筆/粗鋼筆, 微軟正黑體, Microsoft JhengHei, Microsoft YaHei, arial;' ,	
				font_names : "粗钢笔/粗钢笔1,粗钢笔1_youvivid_dynamic_font,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;黑体/黑体1,黑体1_youvivid_dynamic_font,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗行楷体/粗行楷体1,粗行楷体1_youvivid_dynamic_font,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;甜妞体/甜妞体1,甜妞体1_youvivid_dynamic_font,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;", 
				//config.contentsCss = ['/ckeditor/contents_leo.css', 'http://176.34.27.47/fontScript/getfont.pl?family=%E7%B2%97%E9%8B%BC%E7%AD%86&text=ABCDEFG'] 
				//contentsCss : ['/ckeditor/contents_leo.css']
				//contentsCss : []	
				contentsCss : contentcss_array, 
			    removePlugins: 'elementspath' 


			});				
			ck_editor = invite_detail_editor7042;



/*				
        for(i in CKEDITOR.instances) {
            var linkElement = $(CKEDITOR.instances[i].document.$).find('link');
            if (data.editorStylesheet > 0) {
                if (linkElement.length == 0) {
                    $(CKEDITOR.instances[i].document.$).find('head').append('<link rel="stylesheet" type="text/css" href="'+ data.editorStylesheet +'">');
                } else {
                    linkElement.attr('href', data.editorStylesheet)
                }
            } else if (linkElement.length > 0) {
                linkElement.remove();
            }
        }
*/				
	
			});  //jquery functiom
					
			</script>
			


	</div><!--End Tab-XXX -->



	<div id="invite_detail_content7041" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide">
		<div align="right">
        	<input name="invite_detail_id" id="invite_detail_id" type="hidden" value="7041">
            <input name="invite_detail_type" id="invite_detail_type" type="hidden" value="7">
            <input name="bshow7041" type="checkbox" id="bshow7041" value="0">隐藏 
        </div>
		<script>
		$(document).ready(function() {
			//set initial state.
			
			$('#bshow7041').change(function() {
				if ($(this).is(':checked')) {
         			//alert('hide');
					
					//$("#invite_detail_name7041").attr("disabled",true);
					$("#invite_detail_name7041").addClass("tab_name_hide");


					bshow7041 = 0
					$('#iframepage').contents().find("#invite_detail_title7041").hide();
					$('#iframepage').contents().find("#invite_detail_content7041").hide();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "activate" , false )
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } );
				} else {
         			//alert('show');
					//$("#invite_detail_name7041").attr("disabled",false);
					$("#invite_detail_name7041").removeClass("tab_name_hide");
					bshow7041 = 1;
					$('#iframepage').contents().find("#invite_detail_title7041").show();
					$('#iframepage').contents().find("#invite_detail_content7041").show();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } ).accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
				}
				$('#iframepage').get(0).contentWindow.processButtonBackground();	//call iframe function	 

			});
		});
 
        </script>


<!-- case 7 -->

   

              <style>
              #sortable { list-style-type: none; margin: 0; padding: 0; width: 450px; }
              #sortable li { margin: 3px 3px 3px 0; padding: 1px; float: left; width: 100px; height: 110px; font-size: 8pt; text-align: center; cursor: move;}
              #sortable li span{ cursor: pointer; }
				.thumb {
					width: 100px;
					height: 100px;
					overflow: hidden;
				}
				.thumb img.thumbimage  {
					width: 100%;
					height: auto;
				}
              </style>
              <script>
              $(function() {
                  $("#sortable").sortable({
                      
                      deactivate: function(ev, ui){
                          
                          syncGallery();
                      }
                      

                  });
                  
                  $("#sortable").disableSelection();
              });
              </script>
              
              <input id="select_image2" name="select_image2" type="button" value="选择图片">
              

            
            <input type="hidden" name="sn" value="P3NLG">
            
            <input type="hidden" name="invite_usrcookies" value="">
          
            <table width="100%" cellpadding="0" cellspacing="0" border="0">
             <tbody><tr><td width="100%" height="30">

<span id="nopicture">没有图片, 请点击上方按钮添加图片</span>          
              
              <ul id="sortable" name="sortable" class="ui-sortable">
<!--<li id="40240" class="ui-state-default" fileurl="uploads/image/f0904273C82W2683.jpg"  style="text-align: right"><span><img src="./images/close_button.png"></span><BR><img src="uploads/image/f0904273C82W2683.jpg" width="100" height="90"></li>-->

              </ul>
               
              
              
              
              </td></tr>
          
            </tbody></table>
            




<script>
		
var $dialog_photo2;		
		
$(document).ready(function() { 
		     
       
	
		
		$("#select_image2").bind('click', function (e) {
			//alert("select_image");
			e.preventDefault();
			$('#iframepage').contents().find('html, body').animate({scrollTop: 1000});
			var page = 'mobile_slideshow_select_photo_header.asp';
			var pagetitle = '请选择婚纱相册的相片';
			$dialog_photo2 = $('<div></div>')
			.html('<iframe frameborder="0" border="0" cellspacing="0" style="border: none; " src="' + page + '" width="100%" height="100%"></iframe>')
			.dialog({
				autoOpen: false,
				modal: true,
				position: "left",
				height: 610,
				width: 580,
				title: pagetitle,
				buttons: {
					关闭: function() {
                         $( this ).dialog( "close" );
                         
						}
				},
				
				beforeClose: function (event, ui) {
				   syncGallery();
			  }
				  
			});
			$dialog_photo2.dialog('open');

		});


    $("#sortable li span").live("click",function() {
      
          $(this).closest('li').remove();
           
           syncGallery(); 
    
    });
    
});

function syncGallery(){

         var list = '';
  
     		 $('#nopicture').html("");
     		 $('#iframepage').contents().find('#nopicture').html("");
     		 
     		 $('#iframepage').contents().find('#Gallery li').remove();    
         
         $('#iframepage').contents().find("#invite_webimg,#img_decoration1,#img_decoration2,#img_decoration3").css('cursor', 'default');			
         
         if ($('#sortable li').size() > 0){
             
             $('#sortable li').each(function(){
               
                var current = $(this);
    
               if(current.children().size() > 0) {
                
                   var img = current.children().eq(1); 
                   //alert( current.attr('id') + current.attr('fileurl'));    
                   //window.parent.$("#iframepage")[0].contentWindow.addPhotoSwipe( current.attr('id'), img.attr('src'), current.attr('fileurl'), $('#sortable li').size()); // prevent cross domain access restriction of xitie
                   $("#iframepage")[0].contentWindow.addPhotoSwipe( current.attr('id'), img.attr('src'), current.attr('fileurl'), $('#sortable li').size());
                    
                   list = list + "'" + current.attr('id') + "," +  img.attr('src') + "," + current.attr('fileurl') + "'";
                }            
                
                 
             });
             
             $('#iframepage').contents().find("#invite_webimg,#img_decoration1,#img_decoration2,#img_decoration3").css('cursor', 'pointer');			
             
             
         }else{
             $('#nopicture').html("没有图片, 请点击上方按钮添加图片");
             $('#iframepage').contents().find('#nopicture').html("没有图片");
             
         }
         
         document.form_invite.slideshow.value = list.ReplaceAll("''", "|").ReplaceAll("'", "");

}

var oldOnload = window.onload || function () {};
window.onload = function ()
{
    oldOnload();
    syncGallery();
}

</script>


<!-- case 7 -->

	</div><!--End Tab-XXX -->



	<div id="invite_detail_content7043" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide">
		<div align="right">
        	<input name="invite_detail_id" id="invite_detail_id" type="hidden" value="7043">
            <input name="invite_detail_type" id="invite_detail_type" type="hidden" value="3">
            <input name="bshow7043" type="checkbox" id="bshow7043" value="0">隐藏 
        </div>
		<script>
		$(document).ready(function() {
			//set initial state.
			
			$('#bshow7043').change(function() {
				if ($(this).is(':checked')) {
         			//alert('hide');
					
					//$("#invite_detail_name7043").attr("disabled",true);
					$("#invite_detail_name7043").addClass("tab_name_hide");


					bshow7043 = 0
					$('#iframepage').contents().find("#invite_detail_title7043").hide();
					$('#iframepage').contents().find("#invite_detail_content7043").hide();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "activate" , false )
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } );
				} else {
         			//alert('show');
					//$("#invite_detail_name7043").attr("disabled",false);
					$("#invite_detail_name7043").removeClass("tab_name_hide");
					bshow7043 = 1;
					$('#iframepage').contents().find("#invite_detail_title7043").show();
					$('#iframepage').contents().find("#invite_detail_content7043").show();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } ).accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
				}
				$('#iframepage').get(0).contentWindow.processButtonBackground();	//call iframe function	 

			});
		});
 
        </script>



<table width="100%" cellpadding="3" cellspacing="1" border="0">
 <tbody><tr><td colspan="2" align="left" bgcolor="#ffffff">---&nbsp;请输入或修改问卷的相关资料&nbsp;---</td>
   </tr>

 <tr>
   <td width="10%" align="center">
 	提示
   </td>
   <td width="90%">
	<textarea name="qaprompt" id="qaprompt" cols="40" rows="3" style="font-family:微软雅黑,Microsoft YaHei,Microsoft JhengHei,verdana; font-size:9pt;">为了方便统整婚宴资料，请您花几分钟填写以下内容，并在O月O日前回覆，我们的婚宴会因您的协助更加美好。</textarea>     
 <script>
$(document).ready(function() { 
		
		$("#qaprompt").bind('change keydown keyup paste input propertychange',function (){
			$('#iframepage').contents().find("#qaprompt").find("span:eq(0)").html($(this).val()); 
			//setHiddenHtml('remindtitle');
		});
		//$("#remindtitle").bind('focus',function (){
	  // $('#iframepage').contents().find('html, body').animate({scrollTop: 0});
		//});

});		
</script>		
   </td>
 </tr>

</tbody></table>



<table width="100%" cellpadding="3" cellspacing="1" border="0">
<!-- leo move to form beginning
<input type="hidden" name="invite_id" value="1534">
-->
 <tbody><tr>
     <td width="10%" height="30" align="center" valign="middle" bgcolor="#C7C7C7">选取</td>
     <td width="90%" height="30" valign="middle" bgcolor="#C7C7C7">问题</td>
     
     
 </tr>
 
 

 <tr>
     <td width="10%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="hidden" name="questionid" value="12272">
      <input type="hidden" name="answertype" value="2">
      <input type="hidden" name="switch_status" value="1">
      <input type="checkbox" name="status" onclick="showQuestion(&#39;q12272&#39;, this.checked, 0);" value="12272" checked="">
     
     </td>
     <td width="90%" height="30" valign="top" bgcolor="#ffffff">
      
      <!--<input type="text" name="qq" value="您的姓名" size="8" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText'; this.size=this.value.length*2;" onkeyup="setQuestionTitle('12272', this.value);"><br/>-->
         <span class="editable"><input type="text" name="qq" value="您的姓名" size="60" class="showText" onfocus="javascript: this.className=&#39;showInput&#39;;" onblur="javascript: this.className=&#39;showText&#39;;" onkeyup="setQuestionTitle(&#39;12272&#39;, this.value);"></span><br>
     
     <div id="q12272"> 


     <!--<input type="text" name="t12272" value="" size="26">-->

                       
     </div>
     
     

     </td>
 </tr>
 
 

 <tr>
     <td width="10%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="hidden" name="questionid" value="12273">
      <input type="hidden" name="answertype" value="1">
      <input type="hidden" name="switch_status" value="1">
      <input type="checkbox" name="status" onclick="showQuestion(&#39;q12273&#39;, this.checked, 1);" value="12273" checked="">
     
     </td>
     <td width="90%" height="30" valign="top" bgcolor="#ffffff">
      
      <!--<input type="text" name="qq" value="您会来参与我们的婚宴吗?" size="24" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText'; this.size=this.value.length*2;" onkeyup="setQuestionTitle('12273', this.value);"><br/>-->
         <span class="editable"><input type="text" name="qq" value="您会来参与我们的婚宴吗?" size="60" class="showText" onfocus="javascript: this.className=&#39;showInput&#39;;" onblur="javascript: this.className=&#39;showText&#39;;" onkeyup="setQuestionTitle(&#39;12273&#39;, this.value);"></span><br>
     
     <div id="q12273"> 


            <div id="s37081" style="valign: middle;">
            
            <!--<img src="./image/del.png" onclick="delRow('q12273','s37081');" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><input type="text" name="o12273" size="24" value="非常乐意，有{1-10}人参加" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText';this.size=this.value.length*2;" onkeyup="setOptionTitle('37081', this.value);">-->
            <img src="./example_files/del.png" onclick="delRow(&#39;q12273&#39;,&#39;s37081&#39;);" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><span class="editable"><input type="text" name="o12273" size="40" value="非常乐意，有{1-10}人参加" class="showText" onfocus="javascript: this.className=&#39;showInput&#39;;" onblur="javascript: this.className=&#39;showText&#39;;" onkeyup="setOptionTitle(&#39;37081&#39;, this.value);"></span>
            
            </div> 

            <div id="s37082" style="valign: middle;">
            
            <!--<img src="./image/del.png" onclick="delRow('q12273','s37082');" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><input type="text" name="o12273" size="24" value="无法参加" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText';this.size=this.value.length*2;" onkeyup="setOptionTitle('37082', this.value);">-->
            <img src="./example_files/del.png" onclick="delRow(&#39;q12273&#39;,&#39;s37082&#39;);" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><span class="editable"><input type="text" name="o12273" size="40" value="无法参加" class="showText" onfocus="javascript: this.className=&#39;showInput&#39;;" onblur="javascript: this.className=&#39;showText&#39;;" onkeyup="setOptionTitle(&#39;37082&#39;, this.value);"></span>
            
            </div> 

                       
     </div>
     
     
     <img src="./example_files/add.png" onclick="javascript: addRow(&#39;q12273&#39;);" style="cursor: pointer;" vspace="5" hspace="5" align="absmiddle">
     

     </td>
 </tr>
 
 

 <tr>
     <td width="10%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="hidden" name="questionid" value="12274">
      <input type="hidden" name="answertype" value="1">
      <input type="hidden" name="switch_status" value="0">
      <input type="checkbox" name="status" onclick="showQuestion(&#39;q12274&#39;, this.checked, 2);" value="12274">
     
     </td>
     <td width="90%" height="30" valign="top" bgcolor="#ffffff">
      
      <!--<input type="text" name="qq" value="您是新郎还是新娘的宾客？" size="24" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText'; this.size=this.value.length*2;" onkeyup="setQuestionTitle('12274', this.value);"><br/>-->
         <span class="editable"><input type="text" name="qq" value="您是新郎还是新娘的宾客？" size="60" class="showText" onfocus="javascript: this.className=&#39;showInput&#39;;" onblur="javascript: this.className=&#39;showText&#39;;" onkeyup="setQuestionTitle(&#39;12274&#39;, this.value);"></span><br>
     
     <div id="q12274"> 


            <div id="s37083" style="valign: middle;">
            
            <!--<img src="./image/del.png" onclick="delRow('q12274','s37083');" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><input type="text" name="o12274" size="24" value="我是帅新郎的{亲戚|朋友|同学|同事}" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText';this.size=this.value.length*2;" onkeyup="setOptionTitle('37083', this.value);">-->
            <img src="./example_files/del.png" onclick="delRow(&#39;q12274&#39;,&#39;s37083&#39;);" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><span class="editable"><input type="text" name="o12274" size="40" value="我是帅新郎的{亲戚|朋友|同学|同事}" class="showText" onfocus="javascript: this.className=&#39;showInput&#39;;" onblur="javascript: this.className=&#39;showText&#39;;" onkeyup="setOptionTitle(&#39;37083&#39;, this.value);"></span>
            
            </div> 

            <div id="s37084" style="valign: middle;">
            
            <!--<img src="./image/del.png" onclick="delRow('q12274','s37084');" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><input type="text" name="o12274" size="24" value="我是俏新娘的{亲戚|朋友|同学|同事}" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText';this.size=this.value.length*2;" onkeyup="setOptionTitle('37084', this.value);">-->
            <img src="./example_files/del.png" onclick="delRow(&#39;q12274&#39;,&#39;s37084&#39;);" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><span class="editable"><input type="text" name="o12274" size="40" value="我是俏新娘的{亲戚|朋友|同学|同事}" class="showText" onfocus="javascript: this.className=&#39;showInput&#39;;" onblur="javascript: this.className=&#39;showText&#39;;" onkeyup="setOptionTitle(&#39;37084&#39;, this.value);"></span>
            
            </div> 

            <div id="s37085" style="valign: middle;">
            
            <!--<img src="./image/del.png" onclick="delRow('q12274','s37085');" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><input type="text" name="o12274" size="24" value="其他:{}" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText';this.size=this.value.length*2;" onkeyup="setOptionTitle('37085', this.value);">-->
            <img src="./example_files/del.png" onclick="delRow(&#39;q12274&#39;,&#39;s37085&#39;);" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><span class="editable"><input type="text" name="o12274" size="40" value="其他:{}" class="showText" onfocus="javascript: this.className=&#39;showInput&#39;;" onblur="javascript: this.className=&#39;showText&#39;;" onkeyup="setOptionTitle(&#39;37085&#39;, this.value);"></span>
            
            </div> 

                       
     </div>
     
     
     <img src="./example_files/add.png" onclick="javascript: addRow(&#39;q12274&#39;);" style="cursor: pointer;" vspace="5" hspace="5" align="absmiddle">
     

     </td>
 </tr>
 
 

 <tr>
     <td width="10%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="hidden" name="questionid" value="12275">
      <input type="hidden" name="answertype" value="1">
      <input type="hidden" name="switch_status" value="0">
      <input type="checkbox" name="status" onclick="showQuestion(&#39;q12275&#39;, this.checked, 3);" value="12275">
     
     </td>
     <td width="90%" height="30" valign="top" bgcolor="#ffffff">
      
      <!--<input type="text" name="qq" value="需要为您准备素食吗？" size="20" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText'; this.size=this.value.length*2;" onkeyup="setQuestionTitle('12275', this.value);"><br/>-->
         <span class="editable"><input type="text" name="qq" value="需要为您准备素食吗？" size="60" class="showText" onfocus="javascript: this.className=&#39;showInput&#39;;" onblur="javascript: this.className=&#39;showText&#39;;" onkeyup="setQuestionTitle(&#39;12275&#39;, this.value);"></span><br>
     
     <div id="q12275"> 


            <div id="s37086" style="valign: middle;">
            
            <!--<img src="./image/del.png" onclick="delRow('q12275','s37086');" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><input type="text" name="o12275" size="20" value="是的，我需要{1-10}份" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText';this.size=this.value.length*2;" onkeyup="setOptionTitle('37086', this.value);">-->
            <img src="./example_files/del.png" onclick="delRow(&#39;q12275&#39;,&#39;s37086&#39;);" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><span class="editable"><input type="text" name="o12275" size="40" value="是的，我需要{1-10}份" class="showText" onfocus="javascript: this.className=&#39;showInput&#39;;" onblur="javascript: this.className=&#39;showText&#39;;" onkeyup="setOptionTitle(&#39;37086&#39;, this.value);"></span>
            
            </div> 

            <div id="s37087" style="valign: middle;">
            
            <!--<img src="./image/del.png" onclick="delRow('q12275','s37087');" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><input type="text" name="o12275" size="20" value="谢谢，不需要" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText';this.size=this.value.length*2;" onkeyup="setOptionTitle('37087', this.value);">-->
            <img src="./example_files/del.png" onclick="delRow(&#39;q12275&#39;,&#39;s37087&#39;);" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><span class="editable"><input type="text" name="o12275" size="40" value="谢谢，不需要" class="showText" onfocus="javascript: this.className=&#39;showInput&#39;;" onblur="javascript: this.className=&#39;showText&#39;;" onkeyup="setOptionTitle(&#39;37087&#39;, this.value);"></span>
            
            </div> 

                       
     </div>
     
     
     <img src="./example_files/add.png" onclick="javascript: addRow(&#39;q12275&#39;);" style="cursor: pointer;" vspace="5" hspace="5" align="absmiddle">
     

     </td>
 </tr>
 
 

 <tr>
     <td width="10%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="hidden" name="questionid" value="12276">
      <input type="hidden" name="answertype" value="2">
      <input type="hidden" name="switch_status" value="1">
      <input type="checkbox" name="status" onclick="showQuestion(&#39;q12276&#39;, this.checked, 4);" value="12276" checked="">
     
     </td>
     <td width="90%" height="30" valign="top" bgcolor="#ffffff">
      
      <!--<input type="text" name="qq" value="若您需要我们寄送纸本喜帖，请填写地址" size="36" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText'; this.size=this.value.length*2;" onkeyup="setQuestionTitle('12276', this.value);"><br/>-->
         <span class="editable"><input type="text" name="qq" value="若您需要我们寄送纸本喜帖，请填写地址" size="60" class="showText" onfocus="javascript: this.className=&#39;showInput&#39;;" onblur="javascript: this.className=&#39;showText&#39;;" onkeyup="setQuestionTitle(&#39;12276&#39;, this.value);"></span><br>
     
     <div id="q12276"> 


     <!--<input type="text" name="t12276" value="" size="26">-->

                       
     </div>
     
     

     </td>
 </tr>
 
 

 <tr>
     <td width="10%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="hidden" name="questionid" value="12277">
      <input type="hidden" name="answertype" value="1">
      <input type="hidden" name="switch_status" value="0">
      <input type="checkbox" name="status" onclick="showQuestion(&#39;q12277&#39;, this.checked, 5);" value="12277">
     
     </td>
     <td width="90%" height="30" valign="top" bgcolor="#ffffff">
      
      <!--<input type="text" name="qq" value="我们会提供游览车从台中出发，您需要座位吗?" size="42" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText'; this.size=this.value.length*2;" onkeyup="setQuestionTitle('12277', this.value);"><br/>-->
         <span class="editable"><input type="text" name="qq" value="我们会提供游览车从台中出发，您需要座位吗?" size="60" class="showText" onfocus="javascript: this.className=&#39;showInput&#39;;" onblur="javascript: this.className=&#39;showText&#39;;" onkeyup="setQuestionTitle(&#39;12277&#39;, this.value);"></span><br>
     
     <div id="q12277"> 


            <div id="s37088" style="valign: middle;">
            
            <!--<img src="./image/del.png" onclick="delRow('q12277','s37088');" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><input type="text" name="o12277" size="42" value="请提供{1-10}个" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText';this.size=this.value.length*2;" onkeyup="setOptionTitle('37088', this.value);">-->
            <img src="./example_files/del.png" onclick="delRow(&#39;q12277&#39;,&#39;s37088&#39;);" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><span class="editable"><input type="text" name="o12277" size="40" value="请提供{1-10}个" class="showText" onfocus="javascript: this.className=&#39;showInput&#39;;" onblur="javascript: this.className=&#39;showText&#39;;" onkeyup="setOptionTitle(&#39;37088&#39;, this.value);"></span>
            
            </div> 

            <div id="s37089" style="valign: middle;">
            
            <!--<img src="./image/del.png" onclick="delRow('q12277','s37089');" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><input type="text" name="o12277" size="42" value="不需要" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText';this.size=this.value.length*2;" onkeyup="setOptionTitle('37089', this.value);">-->
            <img src="./example_files/del.png" onclick="delRow(&#39;q12277&#39;,&#39;s37089&#39;);" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><span class="editable"><input type="text" name="o12277" size="40" value="不需要" class="showText" onfocus="javascript: this.className=&#39;showInput&#39;;" onblur="javascript: this.className=&#39;showText&#39;;" onkeyup="setOptionTitle(&#39;37089&#39;, this.value);"></span>
            
            </div> 

                       
     </div>
     
     
     <img src="./example_files/add.png" onclick="javascript: addRow(&#39;q12277&#39;);" style="cursor: pointer;" vspace="5" hspace="5" align="absmiddle">
     

     </td>
 </tr>
 
 

 <tr>
     <td width="10%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="hidden" name="questionid" value="12278">
      <input type="hidden" name="answertype" value="2">
      <input type="hidden" name="switch_status" value="1">
      <input type="checkbox" name="status" onclick="showQuestion(&#39;q12278&#39;, this.checked, 6);" value="12278" checked="">
     
     </td>
     <td width="90%" height="30" valign="top" bgcolor="#ffffff">
      
      <!--<input type="text" name="qq" value="请留下您的手机号码" size="18" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText'; this.size=this.value.length*2;" onkeyup="setQuestionTitle('12278', this.value);"><br/>-->
         <span class="editable"><input type="text" name="qq" value="请留下您的手机号码" size="60" class="showText" onfocus="javascript: this.className=&#39;showInput&#39;;" onblur="javascript: this.className=&#39;showText&#39;;" onkeyup="setQuestionTitle(&#39;12278&#39;, this.value);"></span><br>
     
     <div id="q12278"> 


     <!--<input type="text" name="t12278" value="" size="26">-->

                       
     </div>
     
     

     </td>
 </tr>
 
 

 <tr>
     <td width="10%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="hidden" name="questionid" value="12279">
      <input type="hidden" name="answertype" value="2">
      <input type="hidden" name="switch_status" value="0">
      <input type="checkbox" name="status" onclick="showQuestion(&#39;q12279&#39;, this.checked, 7);" value="12279">
     
     </td>
     <td width="90%" height="30" valign="top" bgcolor="#ffffff">
      
      <!--<input type="text" name="qq" value="请留下您的email" size="20" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText'; this.size=this.value.length*2;" onkeyup="setQuestionTitle('12279', this.value);"><br/>-->
         <span class="editable"><input type="text" name="qq" value="请留下您的email" size="60" class="showText" onfocus="javascript: this.className=&#39;showInput&#39;;" onblur="javascript: this.className=&#39;showText&#39;;" onkeyup="setQuestionTitle(&#39;12279&#39;, this.value);"></span><br>
     
     <div id="q12279"> 


     <!--<input type="text" name="t12279" value="" size="26">-->

                       
     </div>
     
     

     </td>
 </tr>
 
 

 <tr>
     <td width="10%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="hidden" name="questionid" value="12280">
      <input type="hidden" name="answertype" value="3">
      <input type="hidden" name="switch_status" value="1">
      <input type="checkbox" name="status" onclick="showQuestion(&#39;q12280&#39;, this.checked, 8);" value="12280" checked="">
     
     </td>
     <td width="90%" height="30" valign="top" bgcolor="#ffffff">
      
      <!--<input type="text" name="qq" value="请留下您对我们的祝福，衷心感谢您" size="32" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText'; this.size=this.value.length*2;" onkeyup="setQuestionTitle('12280', this.value);"><br/>-->
         <span class="editable"><input type="text" name="qq" value="请留下您对我们的祝福，衷心感谢您" size="60" class="showText" onfocus="javascript: this.className=&#39;showInput&#39;;" onblur="javascript: this.className=&#39;showText&#39;;" onkeyup="setQuestionTitle(&#39;12280&#39;, this.value);"></span><br>
     
     <div id="q12280"> 


     <!--<textarea name="t12280" cols="20" rows="6"></textarea>-->

                       
     </div>
     
     

     </td>
 </tr>
 
 
 
 <!--
 <tr><td width="100%" height="50" align="center" bgcolor="#ffffff" colspan="2"><input type="submit" value=" 確定 "></td></tr>
-->
</tbody></table>


			


	</div><!--End Tab-XXX -->



	<div id="invite_detail_content7044" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide">
		<div align="right">
        	<input name="invite_detail_id" id="invite_detail_id" type="hidden" value="7044">
            <input name="invite_detail_type" id="invite_detail_type" type="hidden" value="4">
            <input name="bshow7044" type="checkbox" id="bshow7044" value="0">隐藏 
        </div>
		<script>
		$(document).ready(function() {
			//set initial state.
			
			$('#bshow7044').change(function() {
				if ($(this).is(':checked')) {
         			//alert('hide');
					
					//$("#invite_detail_name7044").attr("disabled",true);
					$("#invite_detail_name7044").addClass("tab_name_hide");


					bshow7044 = 0
					$('#iframepage').contents().find("#invite_detail_title7044").hide();
					$('#iframepage').contents().find("#invite_detail_content7044").hide();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "activate" , false )
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } );
				} else {
         			//alert('show');
					//$("#invite_detail_name7044").attr("disabled",false);
					$("#invite_detail_name7044").removeClass("tab_name_hide");
					bshow7044 = 1;
					$('#iframepage').contents().find("#invite_detail_title7044").show();
					$('#iframepage').contents().find("#invite_detail_content7044").show();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } ).accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
				}
				$('#iframepage').get(0).contentWindow.processButtonBackground();	//call iframe function	 

			});
		});
 
        </script>


  <div class="ui-widget">
  <span id="use_google_map7044">您可以使用下方的谷歌地图, 或<input id="select_map7044" name="select_map7044" type="button" value="选择上传地图"><br></span><input id="remove_map7044" name="remove_map7044" type="button" value="移除地图重新选择" style="display: none;">
  </div>
  
    <input type="hidden" name="invite_detail_latmarker7044" id="invite_detail_latmarker7044" value="31.241401">
    <input type="hidden" name="invite_detail_lngmarker7044" id="invite_detail_lngmarker7044" value="121.512876">
    <input type="hidden" name="invite_detail_latcenter7044" id="invite_detail_latcenter7044" value="31.240629">
    <input type="hidden" name="invite_detail_lngcenter7044" id="invite_detail_lngcenter7044" value="121.512625">
    <input type="hidden" name="invite_detail_zoom7044" id="invite_detail_zoom7044" value="16">
    <input type="hidden" name="invite_detail_mapimgurl7044" id="invite_detail_mapimgurl7044" value="">

    <table width="100%" border="0">
      <tbody><tr>
        <td valign="top">

    <img id="invite_detail_mapimg7044" style="width: 240px; border: thin solid rgb(153, 153, 153); display: none;" src="" width="240" align="top">    
    
     <div id="invite_detail_googlemap7044">   
        <span class="input-prompt" id="input-prompt-0">请输入地址后按下定位</span><input name="address7044" type="text" id="address7044" title="请输入地址后按下定位" value="" size="24" class="input-prompt-0">
        <input type="button" id="button_setmap7044" value="定位">
        <br>
        <div id="map_canvas7044" style="width:240px; height:300px; border:thin; border-style:solid; border-color:#999; margin-bottom:5px;"></div>
        
     </div>   
        </td>
        <td valign="top">
    交通指引说明:<br>
	<textarea name="invite_detail_mapdesc7044" id="invite_detail_mapdesc7044" cols="32" rows="10">{场所名称}
地址：{场所地址}
电话：{联络电话}</textarea>
        </td>
      </tr>
    </tbody></table>


	 <script language="javascript">
    $(document).ready(function() { 
		$('#button_setmap7044').click(function() {
		  codeAddress7044($('#address7044').val());
		});

		$("#invite_detail_mapdesc7044").bind('change keydown keyup paste input propertychange',function (){
			$('#iframepage').contents().find("#map_desc7044").html($(this).val().ReplaceAll('\r\n','\n').ReplaceAll('\n','<br>')); 
			//setHiddenHtml('remindtitle');
		});
		//$("#remindtitle").bind('focus',function (){
	  // $('#iframepage').contents().find('html, body').animate({scrollTop: 0});
		//});
	
		
		
	//	console.log("mapurl="+$("#invite_detail_mapimgurl7044").val()); 

		if ($("#invite_detail_mapimgurl7044").val() == '') {
			$("#invite_detail_mapimg7044").hide();
			$("#invite_detail_googlemap7044").show();
			//$("#remove_map7044").attr("disabled", true);
			$("#remove_map7044").hide();
			$("#use_google_map7044").show();
			
		} else {
			$("#invite_detail_mapimg7044").show();
			$("#invite_detail_googlemap7044").hide();
			//$("#remove_map7044").attr("disabled", false);
			$("#remove_map7044").show();
			$("#use_google_map7044").hide();
	}
		
		
		
		$("#select_map7044").bind('click', function (e) {
			//alert("select_image");
			e.preventDefault();
			var page = 'mobile_invite_select_map_detail.asp?invite_detail_id=7044';
			var pagetitle = '请上传或选择图片作为地图';
			$dialog_photo = $('<div></div>')
			.html('<iframe frameborder="0" border="0" cellspacing="0" style="border: none; " src="' + page + '" width="100%" height="100%"></iframe>')
			.dialog({
				autoOpen: false,
				modal: false,
				//position: "right",
				height: 610,
				width: 580,
				title: pagetitle,
				buttons: {
					关闭: function() {
                         $( this ).dialog( "close" );
						}
				}
			});
			$dialog_photo.dialog('open');




			//$('#title_editor').elrte('val', $('#iframepage').contents().find("#title").html() );
			//$('#title_editor').elrte('updateSource');
		});

		$("#remove_map7044").bind('click', function (e) {

			$("#iframepage").contents().find('#invite_detail_mapimg7044').hide();
			$("#iframepage").contents().find('#map_canvas7044').show();
			$("#iframepage").contents().find('#invite_detail_mapimg7044').attr('src', '');
			$("#iframepage").contents().find('#invite_detail_mapimgurl7044').val('');

			if ($('#iframepage').get(0).contentWindow.$("#accordion").accordion( "option", "active") != $("#tabs").tabs( "option", "selected" ) ) {

				$('#iframepage').get(0).contentWindow.$("#accordion").accordion("activate",$("#tabs").tabs( "option", "selected" ));
			}
			$('#iframepage').get(0).contentWindow.initialize7044();
		
			
			
			
			
			$("#invite_detail_mapimg7044").hide();
			$("#invite_detail_googlemap7044").show();
			$("#invite_detail_mapimg7044").attr('src', '');
			$("#invite_detail_mapimgurl7044").val('');
			//$("#remove_map7044").attr("disabled", true);
			$("#remove_map7044").hide();
			$("#use_google_map7044").show();
			initialize7044();

			//alert("移除MV视频完成");

			
		});



    });		
    </script>		



	</div><!--End Tab-XXX -->



	<div id="invite_detail_content7046" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide">
		<div align="right">
        	<input name="invite_detail_id" id="invite_detail_id" type="hidden" value="7046">
            <input name="invite_detail_type" id="invite_detail_type" type="hidden" value="6">
            <input name="bshow7046" type="checkbox" id="bshow7046" value="0">隐藏 
        </div>
		<script>
		$(document).ready(function() {
			//set initial state.
			
			$('#bshow7046').change(function() {
				if ($(this).is(':checked')) {
         			//alert('hide');
					
					//$("#invite_detail_name7046").attr("disabled",true);
					$("#invite_detail_name7046").addClass("tab_name_hide");


					bshow7046 = 0
					$('#iframepage').contents().find("#invite_detail_title7046").hide();
					$('#iframepage').contents().find("#invite_detail_content7046").hide();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "activate" , false )
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } );
				} else {
         			//alert('show');
					//$("#invite_detail_name7046").attr("disabled",false);
					$("#invite_detail_name7046").removeClass("tab_name_hide");
					bshow7046 = 1;
					$('#iframepage').contents().find("#invite_detail_title7046").show();
					$('#iframepage').contents().find("#invite_detail_content7046").show();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } ).accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
				}
				$('#iframepage').get(0).contentWindow.processButtonBackground();	//call iframe function	 

			});
		});
 
        </script>


<table width="100%" cellpadding="0" cellspacing="0" border="0">
 <tbody><tr><td width="23%" height="30" valign="top" bgcolor="#ffffff">提示文字</td>
     <td width="77%" height="30" valign="top" bgcolor="#ffffff">
<textarea name="remindtitle" id="remindtitle" cols="40" rows="3" style="font-family:微软正黑体,Microsoft JhengHei,Microsoft YaHei,verdana;font-size:9pt;">亲爱的您容易健忘吗？输入您的姓名与手机号码， 婚宴前，我们会有贴心的手机短信提醒</textarea>     

	 </td>
  </tr>
 <tr>
    <td width="23%" height="30" valign="top" bgcolor="#ffffff">发送时间</td>
    <td width="77%" height="30" valign="top" bgcolor="#ffffff">
<!--    
    <select name="yy">
      
      <option value="2013" selected>2013</option>
      
      <option value="2014" >2014</option>
      
    </select>年

    <select name="mm">
      
      <option value="1" >1</option>
      
      <option value="2" >2</option>
      
      <option value="3" >3</option>
      
      <option value="4" >4</option>
      
      <option value="5" >5</option>
      
      <option value="6" >6</option>
      
      <option value="7" >7</option>
      
      <option value="8" >8</option>
      
      <option value="9" >9</option>
      
      <option value="10" >10</option>
      
      <option value="11" >11</option>
      
      <option value="12" selected>12</option>
      
    </select>月
    
    <select name="dd">
      
      <option value="1" >1</option>
      
      <option value="2" >2</option>
      
      <option value="3" >3</option>
      
      <option value="4" >4</option>
      
      <option value="5" >5</option>
      
      <option value="6" >6</option>
      
      <option value="7" >7</option>
      
      <option value="8" >8</option>
      
      <option value="9" >9</option>
      
      <option value="10" >10</option>
      
      <option value="11" >11</option>
      
      <option value="12" >12</option>
      
      <option value="13" >13</option>
      
      <option value="14" >14</option>
      
      <option value="15" >15</option>
      
      <option value="16" >16</option>
      
      <option value="17" >17</option>
      
      <option value="18" selected>18</option>
      
      <option value="19" >19</option>
      
      <option value="20" >20</option>
      
      <option value="21" >21</option>
      
      <option value="22" >22</option>
      
      <option value="23" >23</option>
      
      <option value="24" >24</option>
      
      <option value="25" >25</option>
      
      <option value="26" >26</option>
      
      <option value="27" >27</option>
      
      <option value="28" >28</option>
      
      <option value="29" >29</option>
      
      <option value="30" >30</option>
      
      <option value="31" >31</option>
      
    </select>日
--> 
				<script>

				
                $(function() {

					$.datepicker.regional['en-GB'] = {
						closeText: 'Done',
						prevText: 'Prev',
						nextText: 'Next',
						currentText: 'Today',
						monthNames: ['January','February','March','April','May','June',
						'July','August','September','October','November','December'],
						monthNamesShort: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',
						'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
						dayNames: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],
						dayNamesShort: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
						dayNamesMin: ['Su','Mo','Tu','We','Th','Fr','Sa'],
						weekHeader: 'Wk',
						dateFormat: 'dd/mm/yy',
						firstDay: 1,
						isRTL: false,
						showMonthAfterYear: false,
						yearSuffix: ''};
					
					$.datepicker.regional['zh-TW'] = {
						closeText: '關閉',
						prevText: '&#x3c;上月',
						nextText: '下月&#x3e;',
						currentText: '今天',
						monthNames: ['一月','二月','三月','四月','五月','六月',
						'七月','八月','九月','十月','十一月','十二月'],
						monthNamesShort: ['一','二','三','四','五','六',
						'七','八','九','十','十一','十二'],
						dayNames: ['星期日','星期一','星期二','星期三','星期四','星期五','星期六'],
						dayNamesShort: ['周日','周一','周二','周三','周四','周五','周六'],
						dayNamesMin: ['日','一','二','三','四','五','六'],
						weekHeader: '周',
						dateFormat: 'yy/mm/dd',
						firstDay: 1,
						isRTL: false,
						showMonthAfterYear: true,
						yearSuffix: '年'};

					$.datepicker.regional['zh-CN'] = {
						closeText: '关闭',
						prevText: '&#x3c;上月',
						nextText: '下月&#x3e;',
						currentText: '今天',
						monthNames: ['一月','二月','三月','四月','五月','六月',
						'七月','八月','九月','十月','十一月','十二月'],
						monthNamesShort: ['一','二','三','四','五','六',
						'七','八','九','十','十一','十二'],
						dayNames: ['星期日','星期一','星期二','星期三','星期四','星期五','星期六'],
						dayNamesShort: ['周日','周一','周二','周三','周四','周五','周六'],
						dayNamesMin: ['日','一','二','三','四','五','六'],
						weekHeader: '周',
						dateFormat: 'yy-mm-dd',
						firstDay: 1,
						isRTL: false,
						showMonthAfterYear: true,
						yearSuffix: '年'};
						
/* Japanese initialisation for the jQuery UI date picker plugin. */
/* Written by Kentaro SATO (kentaro@ranvis.com). */
        $.datepicker.regional['ja'] = {
                closeText: '閉じる',
                prevText: '&#x3c;前',
                nextText: '次&#x3e;',
                currentText: '今日',
                monthNames: ['1月','2月','3月','4月','5月','6月',
                '7月','8月','9月','10月','11月','12月'],
                monthNamesShort: ['1月','2月','3月','4月','5月','6月',
                '7月','8月','9月','10月','11月','12月'],
                dayNames: ['日曜日','月曜日','火曜日','水曜日','木曜日','金曜日','土曜日'],
                dayNamesShort: ['日','月','火','水','木','金','土'],
                dayNamesMin: ['日','月','火','水','木','金','土'],
                weekHeader: '週',
                dateFormat: 'yy/mm/dd',
                firstDay: 0,
                isRTL: false,
                showMonthAfterYear: true,
                yearSuffix: '年'};
						
/*
                    $( "#reminddate" ).datepicker({
						//changeMonth: true,
						//changeYear: true,
						closeText: '關閉',
						prevText: '&#x3c;上月',
						nextText: '下月&#x3e;',
						currentText: '今天',
						monthNames: ['一月','二月','三月','四月','五月','六月',
						'七月','八月','九月','十月','十一月','十二月'],
						monthNamesShort: ['一','二','三','四','五','六',
						'七','八','九','十','十一','十二'],
						dayNames: ['星期日','星期一','星期二','星期三','星期四','星期五','星期六'],
						dayNamesShort: ['周日','周一','周二','周三','周四','周五','周六'],
						dayNamesMin: ['日','一','二','三','四','五','六'],
						weekHeader: '周',
						dateFormat: 'yy/mm/dd',
						firstDay: 1,
						isRTL: false,
						showMonthAfterYear: true,
						yearSuffix: '年'
                    });
*/					
					$( "#reminddate" ).datepicker( $.datepicker.regional[ 'zh-CN' ] );


                });




                </script>    
    <input type="text" id="reminddate" name="reminddate" value="2012/5/31" size="15" class="hasDatepicker">

    
    <select id="remindtime" name="remindtime">
      
      <option value="00">00</option>
      
      <option value="01">01</option>
      
      <option value="02">02</option>
      
      <option value="03">03</option>
      
      <option value="04">04</option>
      
      <option value="05">05</option>
      
      <option value="06">06</option>
      
      <option value="07">07</option>
      
      <option value="08">08</option>
      
      <option value="09">09</option>
      
      <option value="10">10</option>
      
      <option value="11">11</option>
      
      <option value="12">12</option>
      
      <option value="13">13</option>
      
      <option value="14" selected="">14</option>
      
      <option value="15">15</option>
      
      <option value="16">16</option>
      
      <option value="17">17</option>
      
      <option value="18">18</option>
      
      <option value="19">19</option>
      
      <option value="20">20</option>
      
      <option value="21">21</option>
      
      <option value="22">22</option>
      
      <option value="23">23</option>
      
    </select>點
    
             
    </td>
 </tr>
 <tr>
    <td width="23%" height="30" valign="top" bgcolor="#ffffff">短信内容</td>
    <td width="77%" height="30" valign="top" bgcolor="#ffffff"><textarea name="remindmsg" id="remindmsg" cols="40" rows="5" onkeyup="javascript: countWords();" style="font-family:微软正黑体,Microsoft JhengHei,Microsoft YaHei,verdana;font-size:9pt;">{新郎}与{新娘}将于{宴客日期}{宴客时间}在{场所名称}举行婚宴，地址:{场所地址}，期待您的到来！</textarea>
      
      <br>可以输入<span id="limitcount">70</span>个字，已输入<span id="keycount">52</span>个字。
      </td>
 </tr>

</tbody></table>
 <script>
$(document).ready(function() { 
		
		$("#remindtitle").bind('change keydown keyup paste input propertychange',function (){
			$('#iframepage').contents().find("#remindtitle").find("span:eq(0)").html($(this).val()); 
			//setHiddenHtml('remindtitle');
		});
		//$("#remindtitle").bind('focus',function (){
	  // $('#iframepage').contents().find('html, body').animate({scrollTop: 0});
		//});

});		
</script>		





	</div><!--End Tab-XXX -->



	<div id="invite_detail_content7045" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide">
		<div align="right">
        	<input name="invite_detail_id" id="invite_detail_id" type="hidden" value="7045">
            <input name="invite_detail_type" id="invite_detail_type" type="hidden" value="5">
            <input name="bshow7045" type="checkbox" id="bshow7045" value="0">隐藏 
        </div>
		<script>
		$(document).ready(function() {
			//set initial state.
			
			$('#bshow7045').change(function() {
				if ($(this).is(':checked')) {
         			//alert('hide');
					
					//$("#invite_detail_name7045").attr("disabled",true);
					$("#invite_detail_name7045").addClass("tab_name_hide");


					bshow7045 = 0
					$('#iframepage').contents().find("#invite_detail_title7045").hide();
					$('#iframepage').contents().find("#invite_detail_content7045").hide();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "activate" , false )
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } );
				} else {
         			//alert('show');
					//$("#invite_detail_name7045").attr("disabled",false);
					$("#invite_detail_name7045").removeClass("tab_name_hide");
					bshow7045 = 1;
					$('#iframepage').contents().find("#invite_detail_title7045").show();
					$('#iframepage').contents().find("#invite_detail_content7045").show();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } ).accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
				}
				$('#iframepage').get(0).contentWindow.processButtonBackground();	//call iframe function	 

			});
		});
 
        </script>
请勾选可使用的分享选项<br>
<br>

<input id="bs0" name="bshow_share" type="hidden" value="0">
<input id="bs1" name="bshow_share" type="hidden" value="0">
 

<input class="cb" id="cb2" type="checkbox" value="1"> <input id="bs2" name="bshow_share" type="hidden" value="0">
<img src="./example_files/email.png" width="25" height="25" align="absmiddle"> 以电子邮件转寄分享<br>

<input class="cb" id="cb3" type="checkbox" value="1"> <input id="bs3" name="bshow_share" type="hidden" value="0">
<img src="./example_files/linebutton_40x40.png" width="25" height="25" align="absmiddle"> 以Line短信息分享<br>
<br>

<script>
$(document).ready(function(){

    $('.cb').click(function(){
        var id = $(this).attr('id');
        var inputId = "#bs" + id.replace("cb", "");
        var divId = "#share_but" + id.replace("cb", "");

        if ($(this).is(":checked")){
		    //alert('clicked: ' + inputId + ', 1' ) ;
            $(inputId).val('1');
			$('#iframepage').contents().find(divId).show();
        }else{
			//alert('clicked: ' + inputId + ', 0' ) ;
            $(inputId).val('0');
			$('#iframepage').contents().find(divId).hide();
        }
    });
});
</script>


	</div><!--End Tab-XXX -->



</div>

</div><!-- End invite_detail -->
                   </div>

                </div>
                <div style="margin-top: 10px">
                  
                  <a href="javascript: saveNew('quicksave');" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage(&#39;edit3&#39;,&#39;&#39;,&#39;images/quicksave_cn_rollin.png&#39;,1)"><img src="./example_files/quicksave_cn.png" name="edit3" border="0" id="edit3" style="vertical-align:middle"></a>

                  <a href="javascript: saveNew('nextstep');" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage(&#39;edit1&#39;,&#39;&#39;,&#39;images/next_big_cn.png&#39;,1)"><img src="./example_files/next_small_cn.png" name="edit1" border="0" id="edit1" style="vertical-align:middle"></a> <span style="color:#C00; ">(点击下一步保存后, 可以免费发喜讯到手机体验)</span>         

  
                </div>
            
            </td>
          </tr>
        </tbody></table>
    </td>
  </tr>
</tbody></table>





</form>  
<table width="945" border="0" cellpadding="0" cellspacing="0">
<tbody><tr>
 <td>			
  
        <style type="text/css">
<!--
.style100 {color: #FFFFFF}
-->
</style>

<table width="100%" height="26" border="0" cellpadding="0" cellspacing="0">
  <tbody><tr>
    <td height="25">&nbsp;</td>
    <td height="25"><div align="center">
        <table width="900" border="0" cellpadding="0" cellspacing="0">
          <tbody><tr>
            <td width="133"><div align="center"><a class="menulink" href="http://cn.youvivid.com/contact.asp">联络我们</a></div></td>
            <td width="4" class="menulink"><div align="center">|</div></td>
            <td width="133"><div align="center"><a class="menulink" href="http://cn.youvivid.com/funssage_faq.asp">常见问题</a></div></td>
            <td width="4" class="menulink"><div align="center">|</div></td>
            <td width="133"><div align="center"><a class="menulink" href="http://cn.youvivid.com/designer_zone_0.asp">设计师专区</a></div></td>
            
            <td width="4" class="menulink"><div align="center">|</div></td>
            <td width="150"><div align="center"><a class="menulink" href="http://cn.youvivid.com/%E5%BE%AE%E4%BF%A1%E8%AF%B7%E6%9F%AC%E6%89%8B%E6%9C%BA%E5%96%9C%E5%B8%96">微信请柬制作</a></div></td>
           
            <td width="4" class="menulink"><div align="center">|</div></td>
            <td width="110"><div align="center"><a class="menulink" href="http://cn.youvivid.com/wed_mv">婚礼视频製作</a></div></td>
            <td width="4" class="menulink"><div align="center">|</div></td>
            <td width="133"><div align="center"><a class="menulink" href="http://cn.youvivid.com/eula.asp" target="_blank">会员服务条款</a></div></td>
            <td width="4" class="menulink"><div align="center">|</div></td>
            <td width="173"><div align="center"><a class="menulink" href="http://cn.youvivid.com/privacy.asp" target="_blank">隐私权保护政策</a></div></td>
            
            <td width="13"><div align="right"></div></td>
          </tr>
        </tbody></table>
    </div></td>
    <td height="25">&nbsp;</td>
  </tr>
</tbody></table>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <tbody><tr>
    <td width="7" align="right"><img src="./example_files/footer_left2.png" width="7" height="41"></td>
    <td width="543" background="./example_files/footer_bg.png" align="left">
	    
        <a href="http://cn.youvivid.com/">婚礼视频</a>
        <a href="http://cn.youvivid.com/">婚礼片头</a>
		<a href="http://cn.youvivid.com/%E5%BE%AE%E4%BF%A1%E8%AF%B7%E6%9F%AC%E6%89%8B%E6%9C%BA%E5%96%9C%E5%B8%96">手机微信喜帖</a>
		
	Copyright c 2009-2012 All Rights Reserved by FLASHANTS Inc. 
	</td>
    <td width="277" align="right" background="./example_files/footer_bg.png" class="langlink">
	

				<a class="langlink" href="http://en.youvivid.com/">English</a> | 
            
				<a class="langlink" href="http://cn.youvivid.com/">简体中文</a> | 
            
				<a class="langlink" href="http://tw.youvivid.com/">繁體中文</a> | 
            
				<a class="langlink" href="http://jp.youvivid.com/">日本語</a> | 
            
	
	</td>
    <td width="12" align="left"><img src="./example_files/footer_right.png" width="12" height="41"></td>
  </tr>
</tbody></table>



<!--把下面代码加到<body>与</body>之间-->

		<style type="text/css">
        .box{width:100px; height:160px; border:0px solid #000; position:fixed; right:0%; top:100%;margin-left:-100px;margin-top:-180px;_position:absolute;_top:expression(eval(document.documentElement.clientHeight+document.documentElement.scrollTop)); _left:expression(eval(document.documentElement.clientWidth+document.documentElement.scrollLeft)); }
        </style>
        <p></p>
        <div class="box" id="box" align="right"><a href="#" onclick="document.getElementById(&#39;box&#39;).style.display = &#39;none&#39;;return false">[X]</a><br><a href="http://cn.youvivid.com/contact_qiao.asp" target="_new"><img src="./example_files/qa_image.gif" alt="有問題嗎? 點此進行線上客服" width="100" height="160" border="0" title="有問題嗎? 點此進行線上客服"></a></div>
<!--
<script language="javascript" src="http://live.zoosnet.net/JS/LsJS.aspx?siteid=LEK80868421"></script>
-->
<!--
	
		<script language="javascript" src="http://live.zoosnet.net/JS/LsJS.aspx?siteid=LEK80868421&float=1&lng=cn"></script>
	
-->




<script src="./example_files/detect_timezone.js" type="text/javascript"></script>
 
<script type="text/javascript">

function setCookie_timezone(c_name,value,exdays)
{
var exdate=new Date();
exdate.setDate(exdate.getDate() + exdays);
var c_value=escape(value) + ((exdays==null) ? "" : "; expires="+exdate.toUTCString());
document.cookie=c_name + "=" + c_value;
}

var timezone = jstz.determine();

setCookie_timezone('usrdata_timezone',timezone.name(),1);
//alert(timezone.name()); 

</script>


<!-- Google 再营销代码 -->
<!--------------------------------------------------
再营销代码不得与个人身份信息相关联，也不得放置在与敏感类别相关的网页上。有关如何设置代码的详细信息和说明，请访问：http://google.com/ads/remarketingsetup
--------------------------------------------------->
<script type="text/javascript">
/* <![CDATA[ */
var google_conversion_id = 994544354;
var google_custom_params = window.google_tag_params;
var google_remarketing_only = true;
/* ]]> */
</script>
<script type="text/javascript" src="./example_files/conversion.js">
</script><iframe name="google_conversion_frame" title="Google conversion frame" width="300" height="13" src="./example_files/saved_resource.html" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no">&lt;img height="1" width="1" border="0" alt="" src="http://googleads.g.doubleclick.net/pagead/viewthroughconversion/994544354/?frame=0&amp;random=1387351443260&amp;cv=7&amp;fst=1387351443260&amp;num=1&amp;fmt=1&amp;guid=ON&amp;u_h=768&amp;u_w=1366&amp;u_ah=744&amp;u_aw=1317&amp;u_cd=24&amp;u_his=3&amp;u_tz=480&amp;u_java=true&amp;u_nplug=7&amp;u_nmime=10&amp;frm=0&amp;url=http%3A//cn.youvivid.com/mobile_invite_edit.asp%3Finvite_id%3D1534%26previewid%3D" /&gt;</iframe>
<noscript>
&lt;div style="display:inline;"&gt;
&lt;img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/994544354/?value=0&amp;amp;guid=ON&amp;amp;script=0"/&gt;
&lt;/div&gt;
</noscript>



 </td>
</tr>
</tbody></table>   

</center>

<script type="text/javascript" src="./example_files/swfobject.js"></script>

<script language="JavaScript" type="text/JavaScript">
<!--
		//swfobject.embedSWF("test.swf", "view_area", "324", "274", "9.0.0","expressInstall.swf");
 var keep_objid;
 MM_preloadImages('images/tb3_btn_1_2.png','images/tb3_begin_2_cn.png')

    function getFavorite( usrid, objid){

        var url = 'favorite_addnew_act.asp?sn=' + objid + '&usrid=' + usrid + '&rnd='+Math.random();

        if( window.XMLHttpRequest){

            xmlhttp2 = new XMLHttpRequest();
            xmlhttp2.open( 'GET', url, false);
            xmlhttp2.send( null);
            setFavorite();
            
        }
        
        else if( window.ActiveXObject){

            xmlhttp2 = new ActiveXObject('Microsoft.XMLHTTP');
            xmlhttp2.open( 'GET', url, false);
            xmlhttp2.onreadystatechange = setFavorite;
            xmlhttp2.send();
        }
              

        

    }
    
    function setFavorite(){

        var rtn;
        
        if( xmlhttp2.readyState == 4 ){ 

            if( xmlhttp2.status == 200){ 

                rtn = xmlhttp2.responseText;
                
                if( rtn == '1'){
                  
                  alert('成功加入模板到[我的收藏]');
                  
                }else if( rtn == '2'){
                  
                  alert('本模板已经存在[我的收藏]');
                  
                }
             }               
              
        }

    }


	var tb_objurl, tb_userdataurl, tb_makeucardurl;
	
// New function for reuse preview to make new asobj.previewid
	function switchSrc_variable3(objurl, userdataurl, objname, objdesc, objassetdesc, objid, asid, webimgurl, objauthor, makeucardurl) {
		
			
		tb_objurl = objurl;
		tb_userdataurl = userdataurl;
		document.getElementById('obj_name').innerHTML=objname;
		document.getElementById('obj_description').innerHTML=objdesc;
		if (objauthor.length > 0 ) document.getElementById('obj_author').innerHTML= '设计师: ' + objauthor;
		document.getElementById('obj_asset_desc').innerHTML=objassetdesc;
		tb_makeucardurl = makeucardurl
		keep_objid = objid;
		//switchSrc();
		//swfobject.embedSWF("expressInstall.swf", "view_area", "324", "274", "9.0.0","expressInstall.swf");

		//alert("set variable!" + objurl);
		
	}


	function switchSrc_variable(objurl, userdataurl, objname, objdesc, objassetdesc, objid, asid, webimgurl, objauthor) {
		tb_objurl = objurl;
		tb_userdataurl = userdataurl;
		document.getElementById('obj_name').innerHTML=objname;
		document.getElementById('obj_description').innerHTML=objdesc;
		if (objauthor.length > 0 ) document.getElementById('obj_author').innerHTML= '设计师: ' + objauthor;
		document.getElementById('obj_asset_desc').innerHTML=objassetdesc;
		tb_makeucardurl = 'preview_new.asp?objid=' + objid + '&asid=' + asid
		keep_objid = objid;
		//alert("set variable!" + objurl);
	}
//This is for index.asp use, no use now
	function switchSrc_variable2(objurl, userdataurl, objname, objdesc, objassetdesc, linkurl) {
		tb_objurl = objurl;
		tb_userdataurl = userdataurl;
		document.getElementById('obj_name').innerHTML=objname;
		document.getElementById('obj_description').innerHTML=objdesc;
		document.getElementById('obj_asset_desc').innerHTML=objassetdesc;
		tb_makeucardurl = linkurl;
		//keep_objid = objid;
		//alert("set variable!" + objurl);
	}

	function switchSrc_variable4(objurl, userdataurl) {
		//alert(objurl);
		tb_objurl = objurl;
		tb_userdataurl = userdataurl;
		switchSrc();
		$('#myOnPageContent').dialog('open');
		
	}


	function clearSrc() {
		tb_objurl = "";
		tb_userdataurl = "";
		switchSrc();
		//swfobject.embedSWF("test.swf", "view_area", "324", "274", "9.0.0","expressInstall.swf");
		//alert("clearSrc!");
	}

	

	function switchSrc(){
		// alert("switchSrc func!");
		
		var flashvars = {
		  playmode: "2",
		  controler: "controler1.swf",
		  objurl: tb_objurl,
		  userdataurl: tb_userdataurl,
		  reCheck: "1"
		};
		
		var params = {
		  base: ".",
		  quality: "high",
		  allowscriptaccess: "always",
		  allowFullScreen: "true",
		  wmode: "opaque"
		};
		
		swfobject.embedSWF("../view_130808_waterMarkv3_head.swf", "view_area", "480", "406", "9.0.0","expressInstall.swf", flashvars, params);

/*
		if (navigator.appName.indexOf("Microsoft Internet")==-1){
			
			if (document.embeds && document.embeds['view']){
				document.embeds['view'].SetVariable("objurl",  tb_objurl);
				document.embeds['view'].SetVariable("userdataurl", tb_userdataurl);
				document.embeds['view'].SetVariable("reCheck", 1);
							  
				//document.embeds['view'].SetVariable("ServerUrl","http://www.youvivid.com/");
				//document.embeds['view'].SetVariable("objurl", "http://www.youvivid.com/" + objurl);
				//document.embeds['view'].SetVariable("userdataurl", "http://www.youvivid.com/" + userdataurl);
				//document.embeds['view'].SetVariable("playmode", "1");
				//document.embeds['view'].SetVariable("bautoplay", "1");
				//document.embeds['view'].SetVariable("reCheck", "1");
				//alert("func1");
			}
		} else if (navigator.appName.indexOf("Microsoft Internet")!=-1){
				document.getElementById('view').SetVariable("objurl", tb_objurl);
				document.getElementById('view').SetVariable("userdataurl", tb_userdataurl);
				document.getElementById('view').SetVariable("reCheck", 1);
		
				//document.getElementById('view').SetVariable("ServerUrl","http://www.youvivid.com/");
				//document.getElementById('view').SetVariable("objurl", "http://www.youvivid.com/" + objurl);
				//document.getElementById('view').SetVariable("userdataurl", "http://www.youvivid.com/" + userdataurl);
				//document.getElementById('view').SetVariable("playmode", "1");
				//document.getElementById('view').SetVariable("bautoplay", "1");
				//document.getElementById('view').SetVariable("reCheck", "1");
				//alert("func2");
		}  
		 //alert("done switchSrc func!");
*/
	}
	function showMoreSample(inobjid) {
		window.open('preview_showcase.asp?showobjid=' + inobjid, 'moreMVSamples' );
	}
-->
</script>
<script language="JavaScript" type="text/JavaScript">
<!--
function MM_preloadImages() { //v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}

function MM_swapImgRestore() { //v3.0
  var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++) x.src=x.oSrc;
}

function MM_findObj(n, d) { //v4.01
  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x && d.getElementById) x=d.getElementById(n); return x;
}

function MM_swapImage() { //v3.0
  var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array; for(i=0;i<(a.length-2);i+=3)
   if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc) x.oSrc=x.src; x.src=a[i+2];}
}

MM_preloadImages('images/tb3_btn_1_1.png','images/tb3_begin_2_cn.png');
//-->
</script>

<script>
	$(function() {
			$( "#myOnPageContent" ).dialog({
				autoOpen: false,
				width: 640, 
				height: 540, 
				modal: true, 
				dialogClass: 'noTitleStuff', 
				resizable: false
			});
	
			$( "#closeVideo" ).click(function() {
				//alert("closeVideo");
				clearSrc();
				$('#myOnPageContent').dialog('close');
				//dialogVideo.dialog("close");
				//setTimeout('tb_remove();',300);
				return false;
			});
	});
	


</script>






<script>



function closeDialog(){
  
  $( "#PhotoSwipeTarget2" ).dialog("close"); 			
  
}


$(function() {
		$( "#closePhotoSwipe" ).click(function() {
			//alert("click closeVideo");
			$("#iframepage")[0].contentWindow.instance_hide();                       
			//$('#PhotoSwipeTarget2').dialog('close');
			return false;
		});
});

function showDialog(){
	
        						$("#PhotoSwipeTarget2").dialog({
								autoOpen: false,
								width: 640, 
								height: 540, 
								modal: true, 
								dialogClass: 'noTitleStuff', 
								resizable: false
                		});
                		
                		$( "#PhotoSwipeTarget2" ).dialog('open');        					
                    // $("#PhotoSwipeTarget").dialog('option', 'position', 'center');
        					
  
}

</script>

<div id="PhotoSwipeTarget2" style="display:none">


  <table width="540" border="0" cellspacing="0" cellpadding="0">
    <tbody><tr>
      <td width="12" height="13" align="left" valign="bottom"><img style="behavior: url(css/iepngfix.htc)" src="./example_files/tb3_1.png" width="12" height="13"></td>
      <td style="behavior: url(css/iepngfix.htc)" background="./example_files/tb3_7.png"><img style="behavior: url(css/iepngfix.htc)" src="./example_files/tb3_7.png" width="21" height="13"></td>
      <td width="21" height="13" align="left" valign="bottom"><img style="behavior: url(css/iepngfix.htc)" src="./example_files/tb3_4.png" width="21" height="13"></td>
    </tr>
    <tr>
      <td style="behavior: url(css/iepngfix.htc)" background="./example_files/tb3_3.png"><img src="./example_files/space.png" width="1" height="13"></td>
      <td bgcolor="#fad1dd"><table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#fad1dd">
          <tbody><tr>
            <td width="33" height="33" align="center" valign="middle">&nbsp;</td>
            <td align="center" valign="middle"></td>
            <td align="right" valign="top"><a id="closePhotoSwipe" href="#" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage(&#39;ImageCloseWin2&#39;,&#39;&#39;,&#39;images/tb3_btn_1_2.png&#39;,1)"><img src="./example_files/tb3_btn_1_1.png" alt="首页" name="ImageCloseWin" border="0" id="ImageCloseWin2"></a></td>
          </tr>
          <tr>
            <td width="33" align="center" valign="middle"></td>
            <td>
				<div id="PhotoSwipeTarget" style="width:480px; height: 406px"></div>
			</td>
            <td align="left" valign="top">
			</td>
          </tr>
          <tr>
            <td width="33" height="33" align="left">
            <img src="./example_files/spacer.gif" width="33" height="1"></td>
            <td align="right">&nbsp;</td>
            <td align="right" valign="top"></td>
          </tr>
      </tbody></table></td>
      <td style="behavior: url(css/iepngfix.htc)" align="left" background="./example_files/tb3_6.png">&nbsp;</td>
    </tr>
    <tr>
      <td width="12" height="21" align="left" valign="top"><img style="behavior: url(css/iepngfix.htc)" src="./example_files/tb3_2.png" width="12" height="21"></td>
      <td style="behavior: url(css/iepngfix.htc)" background="./example_files/tb3_8.png">&nbsp;</td>
      <td width="21" height="21" align="left" valign="top"><img style="behavior: url(css/iepngfix.htc)" src="./example_files/tb3_5.png" width="21" height="21"></td>
    </tr>
  </tbody></table>
</div>

    <script>
        //$(function() {
		$(document).ready(function(){
			
				String.prototype.ReplaceAll = function (AFindText,ARepText){
					raRegExp = new RegExp(AFindText,"g");
					return this.replace(raRegExp,ARepText)
				} 			
                var invite_groomname = $( "#invite_groomname" ),
                    invite_bridename = $( "#invite_bridename" ),
                    invite_activityaddress = $( "#invite_activityaddress" ),
                    allFields = $( [] ).add( invite_groomname ).add( invite_bridename ),
                    tips = $( ".validateTips" );
        
				

                function updateTips( t ) {
                     tips
                        .text( t )
                        .addClass( "ui-state-highlight" );
                    setTimeout(function() {
                     tips
                        .removeClass( "ui-state-highlight", 1500 );
                    }, 4500 );
                }


			


        		// checkLength( invite_groomname, "invite_groomname", 1, 20 );
                function checkLength( o, n, min, max ) {
                    if ( o.val().length > max || o.val().length < min ) {
                        o.addClass( "ui-state-error" );
                        //updateTips( "請輸入" + n + ", must be between " +  min + " and " + max + "." );
                        updateTips( "请输入" + n + ", 本栏位不得空白 " );
                        return false;
                    } else {
                        return true;
                    }
                }
        
		
		
		
		
		
        
                var basicInfoDialog = $( "#basicInfo" ).dialog({
                    width: 600, 
                    height: 380, 
                    modal: true, 
					
               		closeOnEscape: false,
        			//open: function(event, ui) {  $(".ui-dialog-titlebar-close", ui.dialog).hide(); },
					close: function(event, ui) { 
							
					
						},
                    resizable: false,
                    buttons: {
                    //    省略: function() {
					//		
					//		
                    //            $( this ).dialog( "close" );
					//			//$( this ).dialog( "destroy" );
                    //        },

                        确定: function() {
                            var bValid = true;
							var editorBuf, remindBuf, mapDescBuf;
							editorBuf = ck_editor.getData();
							remindBuf = $("#remindmsg").val();
							mapDescBuf = $("#invite_detail_mapdesc7044"  ).val();

							allFields.removeClass( "ui-state-error" );
                            bValid = bValid && checkLength( invite_groomname, "男方姓名", 1, 20 );
                            bValid = bValid && checkLength( invite_bridename, "女方姓名", 1, 20 );
                            if ( bValid ) {
                            	//新郎新娘
                                $("#invite_maintitle").val( $("#invite_maintitle").val().replace( '{新娘}', invite_bridename.val()).replace( '{新郎}', invite_groomname.val()) );	
                                $("#invite_maintitle").change();
								
								editorBuf = editorBuf.ReplaceAll("{新娘}",invite_bridename.val());
								editorBuf = editorBuf.ReplaceAll("{新郎}",invite_groomname.val());
								
								remindBuf = remindBuf.ReplaceAll("{新娘}",invite_bridename.val());
								remindBuf = remindBuf.ReplaceAll("{新郎}",invite_groomname.val());
								//alert(remindBuf);


								//alert(ck_editor.getData());
                            	//日期
                                if ($("#invite_activitydate").datepicker( "getDate" ) != null ){ 
								
									var activityDate = new Date($("#invite_activitydate").val());
									var alertDate = new Date();
									alertDate.setTime(activityDate.getTime()- 3*24*60*60*1000);
									var str_alertDate = '' + alertDate.getFullYear() + '/' + (alertDate.getMonth()+1) + '/' + alertDate.getDate(); 
									//alert(str_alertDate);
									$( "#reminddate" ).datepicker( "setDate" , str_alertDate );

									var dateStr1 = $("#invite_activitydate").val();
									var dateStr2 = dateStr1.ReplaceAll("-","/");
                                    var yyyy = dateStr2.split('/')[0],
                                        mm = dateStr2.split('/')[1],
                                        dd = dateStr2.split('/')[2],
                                        str_activitydate=yyyy + "年" + mm + "月" + dd + "日";
                                        $("#invite_subtitle").val( $("#invite_subtitle").val().replace( '{宴客日期}', str_activitydate) );	
                                        $("#invite_subtitle").change();

										editorBuf = editorBuf.ReplaceAll("{宴客日期}",str_activitydate);
										remindBuf = remindBuf.ReplaceAll("{宴客日期}",str_activitydate);


	                                //alert(yyyy);  
                                } else {
									// 未選擇 日期時間
									var alertDate = new Date();
									
									alertDate.setTime(alertDate.getTime()+ 30*24*60*60*1000);
									var str_alertDate = '' + alertDate.getFullYear() + '/' + (alertDate.getMonth()+1) + '/' + alertDate.getDate(); 
									//alert(str_alertDate);
									$( "#reminddate" ).datepicker( "setDate" , str_alertDate );
								}
                                
                            	//時間

                                if ( $("#invite_activityhour").val().length != 0 ){ 
                                		var str_activitytime = '';
                                    	var hr  = $("#invite_activityhour").val();
                                    	if (hr > 12 )
                                        	hr = hr - 12;
                                        if (hr < 3 || hr > 10  ) { 
                                        	str_activitytime = "中午";
                                        } else {
                                        	str_activitytime = "晚上";
                                        }
                                        str_activitytime = str_activitytime  + hr + "时"
                                               
		                                if ( ! isNaN($("#invite_activityminute").val()) && $("#invite_activityminute").val() > 0  ){
                                        	var mn = $("#invite_activityminute").val();
                                        	str_activitytime = str_activitytime  + mn + "分"
                                        } 
					                                              
                                    
										editorBuf = editorBuf.ReplaceAll("{宴客时间}",str_activitytime);
										remindBuf = remindBuf.ReplaceAll("{宴客时间}",str_activitytime);
                                    
	                                //alert(str_activitytime);  
                                }
                                
                                //地點

                                if ( $("#invite_activityplace").val().length!=0 ){ 
                                    	var str_activityplace = $("#invite_activityplace").val();
										editorBuf = editorBuf.ReplaceAll("{场所名称}",str_activityplace);
										remindBuf = remindBuf.ReplaceAll("{场所名称}",str_activityplace);
										mapDescBuf = mapDescBuf.ReplaceAll("{场所名称}",str_activityplace);
	                                //alert(invite_activityplace);  
                                }
                                //地址

                                if ( $("#invite_activityaddress").val().length!=0 ){ 
                                    	var str_activityaddress = $("#invite_activityaddress").val();
										editorBuf = editorBuf.ReplaceAll("{场所地址}",str_activityaddress);
										remindBuf = remindBuf.ReplaceAll("{场所地址}",str_activityaddress);
										mapDescBuf = mapDescBuf.ReplaceAll("{场所地址}",str_activityaddress);
										 $("#address7044").val($("#invite_activityaddress").val());
										 //fire change event to remove the tip
										 $("#address7044").change();

										 //alert(document.getElementById("address7044").value);
										 // codeAddress7044();
										
										//Set map location if valid
								
								
										var geocoder = new BMap.Geocoder();
										geocoder.getPoint($( "#invite_activityaddress" ).val(), function(point){
										  if (point) {
											map7044_latcenter  = point.lat;
											map7044_lngcenter  = point.lng;
											map7044_latmarker  = point.lat;
											map7044_lngmarker  = point.lng;
											$('#invite_detail_latcenter7044').val(point.lat);  
											$('#invite_detail_lngcenter7044').val(point.lng);  
											$('#invite_detail_latmarker7044').val(point.lat);  
											$('#invite_detail_lngmarker7044').val(point.lng);  
											$('#iframepage').get(0).contentWindow.map7044_latcenter=point.lat;
											$('#iframepage').get(0).contentWindow.map7044_lngcenter=point.lng;
											$('#iframepage').get(0).contentWindow.map7044_latmarker=point.lat;
											$('#iframepage').get(0).contentWindow.map7044_lngmarker=point.lng;
										  } else {
											  //nothing I can do
										  }
										});
								
										
										

                                }
                                //電話
                                if ( $("#invite_contactphone").val().length!=0 ){ 
                                    	var str_contactphone = $("#invite_contactphone").val();
										editorBuf = editorBuf.ReplaceAll("{联络电话}",str_contactphone);
										remindBuf = remindBuf.ReplaceAll("{联络电话}",str_contactphone);
										mapDescBuf = mapDescBuf.ReplaceAll("{联络电话}",str_contactphone);
	                                //alert(str_contactphone);  
                                }

                                ck_editor.setData(editorBuf, function()
								{
	                                ck_editor.fire( 'change' );
								});
								
								// default value of description for weixin
 								$("#invite_description").val(str_activitydate + ' ' + str_activitytime + ' ' + str_activityplace + ' ' + invite_bridename.val() + '&' + invite_groomname.val() );
								
								$("#remindmsg").val(remindBuf);
								$("#invite_detail_mapdesc7044").val(mapDescBuf);
								$("#invite_detail_mapdesc7044").change();
								 countWords();
								basicInfoDialog.closest('div.ui-dialog').appendTo('#form_invite'); //add dialog to form variable								
                                $( this ).dialog( "close" );
								
								reloadMainPanelFont();
								//ck_editor.execCommand( 'reloadWebFont');

		
							
							
		
		
								
								$("#select_image").click();
                            }
                        }
                    }
                }); //basicInfoDialog end
/*
				$( "#invite_activitydate" ).datepicker({
					//changeMonth: true,
					//changeYear: true,
					closeText: '關閉',
					prevText: '&#x3c;上月',
					nextText: '下月&#x3e;',
					currentText: '今天',
					monthNames: ['一月','二月','三月','四月','五月','六月',
					'七月','八月','九月','十月','十一月','十二月'],
					monthNamesShort: ['一','二','三','四','五','六',
					'七','八','九','十','十一','十二'],
					dayNames: ['星期日','星期一','星期二','星期三','星期四','星期五','星期六'],
					dayNamesShort: ['周日','周一','周二','周三','周四','周五','周六'],
					dayNamesMin: ['日','一','二','三','四','五','六'],
					weekHeader: '周',
					dateFormat: 'yy/mm/dd',
					firstDay: 1,
					isRTL: false,
					showMonthAfterYear: true,
					yearSuffix: '年'
				});
*/
				$( "#invite_activitydate" ).datepicker( $.datepicker.regional[ 'zh-CN' ] );
                
        
        }); //end of $(document).ready
        
    


    
    </script>
	
        

                  


<!--<div id="PhotoSwipeTarget" style=" overflow: hidden; position: relative;"></div>-->






<script language="javascript">
<!--

  function init(){

     // syncGallery();   
   
      if (document.getElementById('iframepage').contentWindow.document.getElementById('maintitlehtml').childNodes[0].style.fontWeight == 'bold') selOn( document.getElementById('maintitlehtmlbold'));        
      if (window.frames.iframepage.document.getElementById('maintitlehtml').childNodes[0].style.fontStyle == 'italic') selOn( document.getElementById('maintitlehtmlitalic'));     
      if (window.frames.iframepage.document.getElementById('maintitlehtml').childNodes[0].style.textDecoration == 'underline') selOn( document.getElementById('maintitlehtmlunderline'));
          
      document.getElementById('selSize1').value = window.frames.iframepage.document.getElementById('maintitlehtml').childNodes[0].style.fontSize.replace('px','');
      
      
      if (window.frames.iframepage.document.getElementById('subtitlehtml').childNodes[0].style.fontWeight == 'bold') selOn( document.getElementById('subtitlehtmlbold'));                            
      if (window.frames.iframepage.document.getElementById('subtitlehtml').childNodes[0].style.fontStyle == 'italic') selOn( document.getElementById('subtitlehtmlitalic'));
      if (window.frames.iframepage.document.getElementById('subtitlehtml').childNodes[0].style.textDecoration == 'underline') selOn( document.getElementById('subtitlehtmlunderline'));

      document.getElementById('selSize2').value = window.frames.iframepage.document.getElementById('subtitlehtml').childNodes[0].style.fontSize.replace('px','');
      
      
      countWords();  
  }


-->
</script>
<div id="ui-datepicker-div" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div><div class="ui-dialog ui-widget ui-widget-content ui-corner-all noTitleStuff ui-draggable" tabindex="-1" role="dialog" aria-labelledby="ui-dialog-title-myOnPageContent" style="display: none; z-index: 1000; outline: 0px;"><div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix"><span class="ui-dialog-title" id="ui-dialog-title-myOnPageContent">&nbsp;</span><a href="#" class="ui-dialog-titlebar-close ui-corner-all" role="button"><span class="ui-icon ui-icon-closethick">close</span></a></div><div id="myOnPageContent" style="" class="ui-dialog-content ui-widget-content">


  <table width="540" border="0" cellspacing="0" cellpadding="0">
    <tbody><tr>
      <td width="12" height="13" align="left" valign="bottom"><img style="behavior: url(css/iepngfix.htc)" src="./example_files/tb3_1.png" width="12" height="13"></td>
      <td style="behavior: url(css/iepngfix.htc)" background="./example_files/tb3_7.png"><img style="behavior: url(css/iepngfix.htc)" src="./example_files/tb3_7.png" width="21" height="13"></td>
      <td width="21" height="13" align="left" valign="bottom"><img style="behavior: url(css/iepngfix.htc)" src="./example_files/tb3_4.png" width="21" height="13"></td>
    </tr>
    <tr>
      <td style="behavior: url(css/iepngfix.htc)" background="./example_files/tb3_3.png"><img src="./example_files/space.png" width="1" height="13"></td>
      <td bgcolor="#fad1dd"><table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#fad1dd">
          <tbody><tr>
            <td width="33" height="33" align="center" valign="middle">&nbsp;</td>
            <td align="center" valign="middle"></td>
            
            <td align="right" valign="top"><a id="closeVideo" href="#" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage(&#39;ImageCloseWin&#39;,&#39;&#39;,&#39;images/tb3_btn_1_2.png&#39;,1)"><img src="./example_files/tb3_btn_1_1.png" alt="首页" name="ImageCloseWin" border="0" id="ImageCloseWin"></a></td>
          </tr>
          <tr>
            <td width="33" align="center" valign="middle"></td>
            <td>
            
		<div id="view_area">
			<a href="http://www.adobe.com/go/getflashplayer"><img src="./example_files/space.png" alt="Get Adobe Flash player" width="480" height="406" border="0"></a>
		</div>
<!--            
		    <object id="view" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,28,0" name="view" width="324" height="274" >
		        <param name="movie" value="../view_130808_waterMarkv3_head.swf?playmode=1" />
		        <param name="base" value="." />
		        <param name="quality" value="high" />
                <param name="allowscriptaccess" value="always" />
		        <param name="allowFullScreen" value="true" />
		        <embed src="../view_130808_waterMarkv3_head.swf?playmode=1&controler=controler1.swf" width="324" height="274" quality="high" pluginspage="http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash" type="application/x-shockwave-flash" name="view" base="." allowFullScreen="true"></embed>
	        </object>
-->
			</td>
            <td align="left" valign="top">
			</td>
          </tr>
          <tr>
            <td width="33" height="33" align="left">
            <img src="./example_files/spacer.gif" width="33" height="1"></td>
            <td align="right">&nbsp;</td>
            <td align="right" valign="top"></td>
          </tr>
      </tbody></table></td>
      <td style="behavior: url(css/iepngfix.htc)" align="left" background="./example_files/tb3_6.png">&nbsp;</td>
    </tr>
    <tr>
      <td width="12" height="21" align="left" valign="top"><img style="behavior: url(css/iepngfix.htc)" src="./example_files/tb3_2.png" width="12" height="21"></td>
      <td style="behavior: url(css/iepngfix.htc)" background="./example_files/tb3_8.png">&nbsp;</td>
      <td width="21" height="21" align="left" valign="top"><img style="behavior: url(css/iepngfix.htc)" src="./example_files/tb3_5.png" width="21" height="21"></td>
    </tr>
  </tbody></table>
</div></div><div class="ui-dialog ui-widget ui-widget-content ui-corner-all ui-draggable" tabindex="-1" role="dialog" aria-labelledby="ui-dialog-title-basicInfo" style="display: none; z-index: 1002; outline: 0px; height: auto; width: 600px; top: 134.5px; left: 347.5px;"><div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix"><span class="ui-dialog-title" id="ui-dialog-title-basicInfo">请填写婚宴喜讯基本资料</span><a href="#" class="ui-dialog-titlebar-close ui-corner-all" role="button"><span class="ui-icon ui-icon-closethick">close</span></a></div><div id="basicInfo" style="font-size: 16px; overflow: hidden; width: auto; min-height: 0px; height: 295.80000019073486px;" class="ui-dialog-content ui-widget-content" scrolltop="0" scrollleft="0">
          <p class="validateTips">填写以下资料后点击确定,系统将自动产生您的婚宴喜讯:</p>
    <br>                
    
		    <table width="100%" border="0">
              <tbody><tr>
                <td width="19%" style="text-align: right"><label for="invite_groomname">男方姓名: </label></td>
                <td width="81%"><span class="input-prompt" id="input-prompt-1" style="display: block;">例如:李大仁</span><input class="text ui-widget-content ui-corner-all input-prompt-1" type="text" title="例如:李大仁" id="invite_groomname" name="invite_groomname" value="" size="15">(必填)</td>
              </tr>
              <tr>
                <td style="text-align: right"><label for="invite_bridename">女方姓名: </label></td>
                <td><span class="input-prompt" id="input-prompt-2">例如:程又青</span><input class="text ui-widget-content ui-corner-all input-prompt-2" type="text" title="例如:程又青" id="invite_bridename" name="invite_bridename" value="" size="15">(必填)</td>
              </tr>
              <tr>
                <td style="text-align: right"><label for="invite_activitydate">宴客日期: </label></td>
                <td>
                    <table width="100%" border="0">
                      <tbody><tr>
                        <td><span class="input-prompt" id="input-prompt-3">例:2012/12/31</span><input type="text" title="例:2012/12/31" class="text ui-widget-content ui-corner-all input-prompt-3 hasDatepicker" id="invite_activitydate" name="invite_activitydate" value="" size="15"></td>
                        <td><label for="invite_activityhour">时间: </label></td>
                        <td><span class="input-prompt" id="input-prompt-4">例:12</span><input type="text" title="例:12" class="text ui-widget-content ui-corner-all input-prompt-4" id="invite_activityhour" name="invite_activityhour" value="" size="4"></td>
                        <td><label for="invite_activityminute">时</label></td>
                        <td><span class="input-prompt" id="input-prompt-5">例:30</span><input type="text" title="例:30" class="text ui-widget-content ui-corner-all input-prompt-5" id="invite_activityminute" name="invite_activityminute" value="" size="4"></td>
                        <td><label for="invite_activityminute">分</label></td>
                      </tr>
                    </tbody></table>
                 </td>
              </tr>
              <tr>
                <td style="text-align: right"><label for="invite_activityplace">场所名称: </label></td>
                <td><span class="input-prompt" id="input-prompt-6">例如:国宾饭店二楼国际厅</span><input type="text" title="例如:国宾饭店二楼国际厅" class="text ui-widget-content ui-corner-all input-prompt-6" id="invite_activityplace" name="invite_activityplace" value="" size="30"></td>
              </tr>
              <tr>
                <td style="text-align: right"><label for="invite_activityaddress">场所地址: </label></td>
                <td><span class="input-prompt" id="input-prompt-7">例如:台北市中山北路二段63号</span><input type="text" title="例如:台北市中山北路二段63号" class="text ui-widget-content ui-corner-all input-prompt-7" id="invite_activityaddress" name="invite_activityaddress" value="" size="50"></td>
              </tr>
              <tr>
                <td style="text-align: right"><label for="invite_contactphone">连络电话: </label></td>
                <td><span class="input-prompt" id="input-prompt-8">例如:(02)2551-1111</span><input type="text" title="例如:(02)2551-1111" class="text ui-widget-content ui-corner-all input-prompt-8" id="invite_contactphone" name="invite_contactphone" value="" size="20"></td>
              </tr>
            </tbody></table>
        </div><div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"><div class="ui-dialog-buttonset"><button type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">确定</span></button></div></div></div>
<script type="text/javascript" src="./example_files/m-webim-lite.js" charset="utf-8"></script></body></html>